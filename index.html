
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Tools Hub - Explore o Futuro da Tecnologia</title>
    <!-- Tailwind CSS CDN (Development Only - replace for production) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- Base Variables & Theme --- */
        :root {
            --bg-dark: #0f172a; --bg-card: #1e293b; --bg-card-hover: #334155;
            --text-main: #e2e8f0; --text-muted: #94a3b8; --text-heading: #f1f5f9;
            --primary: #2563eb; --primary-hover: #1d4ed8; --accent: #0ea5e9; --accent-hover: #0284c7;
            --accent-glow: rgba(14, 165, 233, 0.4); --primary-glow: rgba(37, 99, 235, 0.4);
            --border-color: #334155; --border-color-light: #475569;
            --danger: #dc2626; --danger-hover: #b91c1c;
            --font-body: 'Inter', sans-serif; --font-heading: 'Orbitron', sans-serif;
        }
        html { scroll-behavior: smooth; }
        body { font-family: var(--font-body); background-color: var(--bg-dark); color: var(--text-main); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
        h1, h2, h3, h4, h5, h6 { font-family: var(--font-heading); letter-spacing: 0.05em; color: var(--text-heading); }

        /* --- Custom Scrollbar --- */
        ::-webkit-scrollbar { width: 8px; height: 8px;}
        ::-webkit-scrollbar-track { background: var(--bg-card); }
        ::-webkit-scrollbar-thumb { background-color: var(--primary); border-radius: 10px; border: 2px solid var(--bg-card); }
        ::-webkit-scrollbar-thumb:hover { background-color: var(--primary-hover); }

        /* --- Card Styling --- */
        .tool-card { background-color: var(--bg-card); border: 1px solid var(--border-color); transition: all 0.3s ease-in-out; border-radius: 12px; display: flex; flex-direction: column; height: 100%; }
        .tool-card:hover { transform: translateY(-8px) scale(1.01); background-color: var(--bg-card-hover); border-color: var(--accent); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4), 0 0 15px var(--accent-glow); }
        .tool-card a { display: flex; flex-direction: column; height: 100%; text-decoration: none; color: inherit; }
        .tool-media-container, .tool-media-container-list { position: relative; overflow: hidden; background-color: var(--border-color); flex-shrink: 0; }
        .tool-media-container { height: 200px; border-top-left-radius: 11px; border-top-right-radius: 11px; }
        .tool-media-container-list { width: 220px; height: 100%; border-top-left-radius: 11px; border-bottom-left-radius: 11px; }
        .tool-media-container img, .tool-media-container video, .tool-media-container-list img, .tool-media-container-list video { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s ease; }
        .tool-card:hover .tool-media-container img, .tool-card:hover .tool-media-container video, .tool-card:hover .tool-media-container-list img, .tool-card:hover .tool-media-container-list video { transform: scale(1.08); }

        /* --- Tags --- */
        .tag { display: inline-block; font-size: 0.7rem; font-weight: 600; padding: 3px 10px; border-radius: 9999px; line-height: 1.2; text-transform: uppercase; letter-spacing: 0.05em; }
        .tag-free { background-color: #10b981; color: white; } .tag-paid { background-color: #f59e0b; color: white; } .tag-both { background: linear-gradient(90deg, #10b981 50%, #f59e0b 50%); color: white; } .tag-category { background-color: var(--border-color); color: var(--text-muted); } .tag-essential { background-color: var(--primary); color: white; } .tag-badge { background-color: var(--accent); color: var(--bg-dark); }

        /* --- Buttons & Inputs --- */
        .form-input, .form-select, .form-textarea { background-color: var(--bg-dark); border: 1px solid var(--border-color); color: var(--text-main); border-radius: 8px; padding: 0.6rem 1rem; width: 100%; transition: border-color 0.2s ease, box-shadow 0.2s ease; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { border-color: var(--accent); box-shadow: 0 0 0 2px var(--accent-glow); outline: none; }
        .form-textarea { min-height: 80px; }
        .form-label { display: block; color: var(--text-muted); margin-bottom: 0.25rem; font-size: 0.875rem; font-weight: 500; }
        .form-check-label { font-size: 0.875rem; color: var(--text-main); }
        .form-check-input { width: 1rem; height: 1rem; border-radius: 4px; border-color: var(--border-color); background-color: var(--bg-dark); } .form-check-input:checked { background-color: var(--primary); border-color: var(--primary); } .form-check-input:focus { ring: 2px; ring-offset-0; ring-color: var(--accent-glow); }

        .btn { display: inline-flex; align-items: center; justify-content: center; border-radius: 8px; transition: all 0.2s ease; font-weight: 500; padding: 0.6rem 1.2rem; text-align: center; border: 1px solid transparent; cursor: pointer; white-space: nowrap;}
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .btn i { margin-right: 0.5rem; }
        .btn-sm { padding: 0.4rem 0.8rem; font-size: 0.875rem;}
        .btn-primary { background-color: var(--primary); color: white; border-color: var(--primary); } .btn-primary:hover:not(:disabled) { background-color: var(--primary-hover); border-color: var(--primary-hover); box-shadow: 0 0 10px var(--primary-glow); }
        .btn-accent { background-color: var(--accent); color: var(--bg-dark); font-weight: 600; border-color: var(--accent); } .btn-accent:hover:not(:disabled) { background-color: var(--accent-hover); border-color: var(--accent-hover); box-shadow: 0 0 10px var(--accent-glow); }
        .btn-secondary { background-color: var(--bg-card-hover); color: var(--text-main); border-color: var(--border-color); } .btn-secondary:hover:not(:disabled) { background-color: var(--border-color); color: white; }
        .btn-danger { background-color: var(--danger); color: white; border-color: var(--danger);} .btn-danger:hover:not(:disabled) { background-color: var(--danger-hover); border-color: var(--danger-hover); }
        .btn-icon { padding: 0.5rem; }

        /* --- Category Buttons --- */
        .category-button { background-color: var(--bg-card); color: var(--text-muted); border: 1px solid var(--border-color); transition: all 0.2s ease; flex-shrink: 0; border-radius: 8px; display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 500; white-space: nowrap; cursor: pointer; }
        .category-button:hover { color: var(--text-main); background-color: var(--bg-card-hover); border-color: var(--accent); }
        .category-button.active { color: white; background-color: var(--primary); border-color: var(--primary); box-shadow: 0 0 10px var(--primary-glow); }
        .category-button i { width: 1em; text-align: center; }

        /* --- Modals (Login/Admin) --- */
         .overlay-panel { background-color: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px); display: flex; position: fixed; inset: 0; z-index: 50; align-items: center; justify-content: center;}
         .modal-content { background-color: var(--bg-card); border: 1px solid var(--border-color); border-radius: 16px; color: var(--text-main); box-shadow: 0 15px 40px rgba(0,0,0,0.5); width: 100%; overflow: hidden; display: flex; flex-direction: column; }
         .modal-header { padding: 1.25rem; border-bottom: 1px solid var(--border-color-light); flex-shrink: 0; display: flex; justify-content: space-between; align-items: center;}
         .modal-body { padding: 1.5rem; overflow-y: auto; flex-grow: 1; }
         .modal-footer { padding: 1rem 1.5rem; border-top: 1px solid var(--border-color-light); flex-shrink: 0; background-color: var(--bg-dark); border-bottom-left-radius: 16px; border-bottom-right-radius: 16px; }
         .modal-close-btn { background: none; border: none; color: var(--text-muted); font-size: 1.5rem; line-height: 1; padding: 0.5rem; cursor: pointer; transition: color 0.2s ease; } .modal-close-btn:hover { color: var(--text-main); }

        /* --- Admin Table --- */
        .admin-table-container { flex-grow: 1; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px; position: relative; }
        .admin-table { min-width: 100%; border-collapse: collapse; } /* Use collapse for better borders */
        .admin-table thead { background-color: var(--bg-dark); position: sticky; top: 0; z-index: 1; }
        .admin-table th { padding: 0.75rem 1rem; text-align: left; font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 1px solid var(--border-color-light); }
        .admin-table td { padding: 0.75rem 1rem; font-size: 0.875rem; border-top: 1px solid var(--border-color); }
        .admin-table tbody tr:hover { background-color: var(--bg-card-hover); }
        .admin-table .actions { text-align: right; white-space: nowrap; } .admin-table .actions button { margin-left: 0.5rem; padding: 0.25rem; line-height: 1; }

        /* --- Utilities & Layout --- */
        .container { max-width: 1280px; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem;}
        .section-padding { padding-top: 2.5rem; padding-bottom: 2.5rem; } @media (min-width: 768px) { .section-padding { padding-top: 3rem; padding-bottom: 3rem; } }
        .section-title { margin-bottom: 1.5rem; } @media (min-width: 768px) { .section-title { margin-bottom: 2rem; } }
        .grid-layout { display: grid; gap: 1.5rem; } @media (min-width: 768px) { .grid-layout { gap: 2rem; } }
        .grid-layout-cols { grid-template-columns: repeat(1, minmax(0, 1fr)); } @media (min-width: 640px) { .grid-layout-cols { grid-template-columns: repeat(2, minmax(0, 1fr)); } } @media (min-width: 1024px) { .grid-layout-cols { grid-template-columns: repeat(3, minmax(0, 1fr)); } } @media (min-width: 1280px) { .grid-layout-cols { grid-template-columns: repeat(4, minmax(0, 1fr)); } }
        .list-layout { display: flex; flex-direction: column; gap: 1.5rem; } @media (min-width: 768px) { .list-layout { gap: 2rem; } }

        .line-clamp-2 { overflow: hidden; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; }
        .line-clamp-3 { overflow: hidden; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 3; }
        @keyframes spin { to { transform: rotate(360deg); } } .animate-spin { animation: spin 1s linear infinite; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } } .animate-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; transform: translate3d(0, 0, 0); }
        /* Add FadeIn Animation */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fadeIn { animation: fadeIn 0.5s ease-out forwards; opacity: 0; }

        .hidden { display: none !important; }

        /* Styles for Glassmorphism effect */
        .glassmorphism {
            background: rgba(30, 41, 59, 0.6); /* Slightly transparent bg-card */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px); /* For Safari */
            border-radius: 16px;
            border: 1px solid rgba(51, 65, 85, 0.4); /* Lighter border-color */
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }


    </style>
    <!-- Tailwind Config -->
    <script>
         tailwind.config = { theme: { extend: { /* Keep previous extends */ colors: { 'bg-dark': 'var(--bg-dark)', 'bg-card': 'var(--bg-card)', 'bg-card-hover': 'var(--bg-card-hover)', 'text-main': 'var(--text-main)', 'text-muted': 'var(--text-muted)', 'text-heading': 'var(--text-heading)', primary: 'var(--primary)', 'primary-hover': 'var(--primary-hover)', accent: 'var(--accent)', 'accent-hover': 'var(--accent-hover)', 'border-color': 'var(--border-color)', 'border-color-light': 'var(--border-color-light)', danger: 'var(--danger)', 'danger-hover': 'var(--danger-hover)' }, fontFamily: { sans: ['Inter', 'sans-serif'], heading: ['Orbitron', 'sans-serif'], }, borderRadius: { 'xl': '12px', '2xl': '16px', }, boxShadow: { 'glow-accent': '0 0 15px var(--accent-glow)', 'glow-primary': '0 0 15px var(--primary-glow)', } } } }
    </script>
</head>
<body class="min-h-screen">

    <!-- Login Overlay -->
    <div id="loginOverlay" class="overlay-panel p-4 hidden">
        <div class="modal-content w-full max-w-md">
            <div class="modal-header">
                <h3 class="text-xl font-bold text-accent">Admin Login</h3>
                <button id="closeLoginBtn" class="modal-close-btn" aria-label="Fechar login">×</button>
            </div>
            <form id="loginForm">
                <div class="modal-body space-y-4">
                    <div>
                        <label for="username" class="form-label">Usuário</label>
                        <input type="text" id="username" name="username" required class="form-input" value="admin">
                    </div>
                    <div>
                        <label for="password" class="form-label">Senha</label>
                        <input type="password" id="password" name="password" required class="form-input" value="123456">
                    </div>
                    <p id="loginErrorMsg" class="text-red-500 text-sm hidden !mt-2">Usuário ou senha inválidos.</p>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary w-full">Entrar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Panel (Modal Style) -->
    <div id="adminPanel" class="overlay-panel p-4 hidden">
        <div class="modal-content w-full max-w-5xl h-[90vh]">
            <div class="modal-header">
                <h3 class="text-xl font-bold text-accent">Admin Dashboard</h3>
                <button id="closeAdminBtn" class="modal-close-btn" aria-label="Fechar painel admin">×</button>
            </div>
            <div class="modal-body">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 xl:gap-8 h-full">
                    <!-- Form Section -->
                    <form id="adminForm" class="bg-bg-dark p-5 rounded-xl border border-border-color flex flex-col space-y-4">
                        <h4 id="adminFormTitle" class="font-semibold text-lg mb-0 text-accent flex-shrink-0">Adicionar Nova Ferramenta</h4>
                        <input type="hidden" id="adminToolIdInput" value="">
                        <div class="space-y-4 flex-grow overflow-y-auto pr-2"> <!-- Scrollable Form Fields -->
                             <div><label for="adminToolNameInput" class="form-label">Nome</label><input type="text" id="adminToolNameInput" required class="form-input"></div>
                             <div><label for="adminToolDescInput" class="form-label">Descrição</label><textarea id="adminToolDescInput" required rows="3" class="form-textarea"></textarea></div>
                             <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                 <div><label for="adminToolCategorySelect" class="form-label">Categoria</label><select id="adminToolCategorySelect" class="form-select">{/* Options */}</select></div>
                                 <div><label for="adminToolTypeSelect" class="form-label">Tipo</label><select id="adminToolTypeSelect" class="form-select"><option value="free">Grátis</option><option value="paid">Pago</option><option value="both">Grátis/Pago</option></select></div>
                             </div>
                             <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div><label for="adminToolUrlInput" class="form-label">URL do Site</label><input type="url" id="adminToolUrlInput" required class="form-input" placeholder="https://..."></div>
                                <div><label for="adminToolMediaInput" class="form-label">URL Mídia (Opcional)</label><input type="text" id="adminToolMediaInput" class="form-input" placeholder="Padrão Unsplash se vazio"></div> <!-- Placeholder updated -->
                             </div>
                             <div class="flex items-center space-x-6 pt-2">
                                 <div class="flex items-center space-x-2"><input type="checkbox" id="adminToolFeaturedCheckbox" class="form-check-input"><label for="adminToolFeaturedCheckbox" class="form-check-label">Destaque</label></div>
                                 <div class="flex items-center space-x-2"><input type="checkbox" id="adminToolEssentialCheckbox" class="form-check-input"><label for="adminToolEssentialCheckbox" class="form-check-label">Essencial</label></div>
                             </div>
                         </div>
                         <div class="flex gap-3 pt-4 border-t border-border-color flex-shrink-0"> <!-- Buttons outside scroll -->
                            <button type="submit" id="adminAddBtn" class="btn btn-primary flex-grow"><i class="fas fa-plus"></i>Adicionar</button>
                            <button type="button" id="adminUpdateBtn" class="btn btn-accent flex-grow hidden"><i class="fas fa-save"></i>Atualizar</button>
                            <button type="button" id="adminCancelEditBtn" class="btn btn-secondary hidden"><i class="fas fa-times"></i>Cancelar</button>
                         </div>
                    </form>

                    <!-- Management Section -->
                    <div class="bg-bg-dark p-5 rounded-xl border border-border-color flex flex-col">
                         <h4 class="font-semibold text-lg mb-4 text-accent flex-shrink-0">Gerenciar Ferramentas</h4>
                         <div class="flex space-x-2 mb-4 flex-shrink-0">
                             <input type="text" id="adminSearchInput" placeholder="Buscar na lista..." class="form-input flex-grow">
                             <button id="adminSearchBtn" class="btn btn-primary btn-icon" aria-label="Buscar"><i class="fas fa-search !mr-0"></i></button>
                         </div>
                         <div class="admin-table-container mb-4">
                             <table class="admin-table">
                                 <thead><tr><th>Nome</th><th class="actions">Ações</th></tr></thead>
                                 <tbody id="adminToolsListTbody"></tbody>
                             </table>
                         </div>
                         <!-- MODIFIED: Added CSV Buttons -->
                         <div class="mt-auto space-y-3 flex-shrink-0">
                            <div class="grid grid-cols-2 gap-3">
                                <button id="adminExportBtn" class="btn btn-secondary w-full text-sm"><i class="fas fa-file-code"></i>Exportar (JSON)</button>
                                <button id="adminImportBtn" class="btn btn-secondary w-full text-sm"><i class="fas fa-file-code"></i>Importar (JSON)</button>
                                <button id="adminExportCsvBtn" class="btn btn-secondary w-full text-sm"><i class="fas fa-file-csv"></i>Exportar (CSV)</button>
                                <button id="adminImportCsvBtn" class="btn btn-secondary w-full text-sm"><i class="fas fa-file-csv"></i>Importar (CSV)</button>
                            </div>
                        </div>
                        <!-- END MODIFICATION -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Admin Toggle -->
    <button id="adminToggleBtn" title="Painel Admin" class="fixed bottom-6 right-6 z-30 btn btn-primary btn-icon !p-4 rounded-full shadow-lg hover:shadow-glow-primary transition-all transform hover:scale-110">
        <i class="fas fa-user-shield text-xl !mr-0"></i>
    </button>

    <!-- Main Layout -->
    <div class="flex flex-col min-h-screen">
        <!-- Header -->
        <header class="bg-bg-dark/80 backdrop-blur-md shadow-md shadow-black/20 sticky top-0 z-30 border-b border-border-color">
            <div class="container">
                <div class="flex justify-between items-center gap-4 py-3">
                    <a href="/" class="flex items-center space-x-3 group flex-shrink-0">
                        <div class="bg-gradient-to-br from-primary to-accent p-2 rounded-lg shadow-md group-hover:shadow-glow-primary transition-shadow">
                            <i class="fas fa-robot text-white text-xl"></i>
                        </div>
                        <h1 class="text-xl font-bold text-text-main group-hover:text-accent transition-colors hidden sm:block">AI Tools Hub</h1>
                         <h1 class="text-xl font-bold text-text-main group-hover:text-accent transition-colors sm:hidden">AITools</h1>
                    </a>
                    <div class="flex items-center space-x-2 sm:space-x-3">
                        <div class="relative hidden lg:inline-block text-left">
                            <button type="button" class="btn btn-secondary btn-sm" id="languageMenuBtn">
                                <i class="fas fa-globe !mr-1"></i> PT-BR <i class="fas fa-chevron-down text-xs ml-1"></i>
                            </button>
                            <div class="origin-top-right absolute right-0 mt-2 w-32 rounded-md shadow-lg bg-bg-card ring-1 ring-black ring-opacity-5 focus:outline-none hidden border border-border-color" id="languageDropdown">
                                <div class="py-1"><a href="#" class="text-text-muted block px-4 py-2 text-sm hover:bg-bg-card-hover hover:text-text-main">PT-BR</a><a href="#" class="text-text-muted block px-4 py-2 text-sm hover:bg-bg-card-hover hover:text-text-main">EN-US</a><a href="#" class="text-text-muted block px-4 py-2 text-sm hover:bg-bg-card-hover hover:text-text-main">ES-ES</a></div>
                            </div>
                         </div>
                        <div class="hidden md:flex space-x-2">
                             <button id="listViewBtn" title="List View" class="view-toggle btn btn-secondary btn-icon"><i class="fas fa-list !mr-0"></i></button>
                             <button id="gridViewBtn" title="Grid View" class="view-toggle btn btn-secondary btn-icon"><i class="fas fa-th-large !mr-0"></i></button>
                        </div>
                        <button class="btn btn-primary btn-sm">
                            <i class="fas fa-user-plus text-xs sm:text-sm !mr-1 sm:!mr-1.5"></i>
                            <span class="hidden sm:inline">Sign Up</span><span class="sm:hidden">Up</span>
                        </button>
                        <button id="mobileMenuBtn" class="md:hidden btn btn-secondary btn-icon !p-1.5" aria-label="Abrir menu"><i class="fas fa-bars text-lg !mr-0"></i></button>
                    </div>
                </div>
            </div>
        </header>

         <!-- Mobile Menu -->
        <div id="mobileMenuContent" class="hidden bg-bg-card shadow-lg z-20 md:hidden border-b border-border-color">
             <div class="container py-4 space-y-4">
                 <div class="flex space-x-2 justify-center">
                    <button id="mobileListViewBtn" class="view-toggle flex-1 btn btn-secondary"><i class="fas fa-list"></i> List</button>
                    <button id="mobileGridViewBtn" class="view-toggle flex-1 btn btn-secondary"><i class="fas fa-th-large"></i> Grid</button>
                </div>
                 <div class="relative text-left w-full">
                     <button type="button" class="btn btn-secondary w-full flex justify-between items-center" id="mobileLanguageMenuBtn">
                        <span><i class="fas fa-globe !mr-1"></i> PT-BR</span> <i class="fas fa-chevron-down text-xs"></i>
                    </button>
                    <div class="origin-top-right absolute right-0 mt-2 w-full rounded-md shadow-lg bg-bg-card ring-1 ring-border-color ring-opacity-50 focus:outline-none hidden" id="mobileLanguageDropdown">
                         <div class="py-1"><a href="#" class="text-text-muted block px-4 py-2 text-sm hover:bg-bg-card-hover hover:text-text-main">PT-BR</a><a href="#" class="text-text-muted block px-4 py-2 text-sm hover:bg-bg-card-hover hover:text-text-main">EN-US</a><a href="#" class="text-text-muted block px-4 py-2 text-sm hover:bg-bg-card-hover hover:text-text-main">ES-ES</a></div>
                    </div>
                 </div>
             </div>
         </div>

        <!-- Hero Section -->
        <section class="bg-gradient-to-b from-bg-dark via-slate-800 to-bg-dark text-white relative overflow-hidden section-padding">
             <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900/30 via-transparent to-transparent opacity-50"></div>
             <div class="container text-center relative z-10">
                <h2 class="text-4xl md:text-5xl font-bold mb-5 text-transparent bg-clip-text bg-gradient-to-r from-white via-sky-300 to-accent">Explore o Futuro da Tecnologia</h2>
                <p class="text-lg md:text-xl mb-10 max-w-3xl mx-auto text-text-muted">Navegue por centenas de ferramentas de IA, design, produtividade e mais.</p>
                <div class="max-w-2xl mx-auto relative">
                     <input type="text" id="mainSearchInput" placeholder="Busque por nome, categoria ou palavra-chave..." class="form-input w-full !pl-6 !pr-28 sm:!pr-32 !py-3.5 rounded-full text-base focus:outline-none">
                     <button id="mainSearchBtn" class="absolute right-2 top-1/2 transform -translate-y-1/2 btn btn-accent !px-4 sm:!px-5 !py-2 rounded-full transition hover:scale-105 text-sm">
                         <i class="fas fa-search !mr-0 sm:!mr-1.5"></i><span class="hidden sm:inline">Buscar</span>
                     </button>
                </div>
            </div>
        </section>

        <!-- Stats Section -->
         <section id="statsSection" class="py-8 md:py-10 bg-slate-800 border-y border-border-color">
             <div class="container">
                 <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-8 text-center">
                     <div class="bg-bg-card p-4 rounded-lg border border-border-color"><i class="fas fa-tools text-accent text-2xl mb-2"></i><div id="statTotalTools" class="text-2xl font-bold text-white">0</div><div class="text-sm text-text-muted">Ferramentas</div></div>
                     <div class="bg-bg-card p-4 rounded-lg border border-border-color"><i class="fas fa-tags text-accent text-2xl mb-2"></i><div id="statTotalCategories" class="text-2xl font-bold text-white">0</div><div class="text-sm text-text-muted">Categorias</div></div>
                     <div class="bg-bg-card p-4 rounded-lg border border-border-color"><i class="fas fa-star text-yellow-400 text-2xl mb-2"></i><div id="statFeaturedTools" class="text-2xl font-bold text-white">0</div><div class="text-sm text-text-muted">Destaques</div></div>
                     <div class="bg-bg-card p-4 rounded-lg border border-border-color"><i class="fas fa-check-circle text-green-500 text-2xl mb-2"></i><div id="statEssentialTools" class="text-2xl font-bold text-white">0</div><div class="text-sm text-text-muted">Essenciais</div></div>
                 </div>
             </div>
         </section>

        <!-- Filters & Categories Section -->
        <section class="sticky top-[60px] md:top-[68px] z-20 bg-bg-dark/95 backdrop-blur-lg py-4 border-b border-border-color">
            <div class="container space-y-4">
                <div class="flex flex-col md:flex-row justify-between items-center gap-3 md:gap-4">
                     <div class="flex flex-wrap items-center gap-2 w-full md:w-auto">
                         <h3 class="text-md font-semibold text-text-muted mr-2 hidden lg:block whitespace-nowrap">Filtros:</h3>
                         <select id="filterCategorySelect" class="form-select !py-1.5 !px-3 text-sm w-full sm:w-auto flex-grow md:flex-grow-0"><option value="all">Todas Categorias</option>{/* Populated */}</select>
                         <select id="filterTypeSelect" class="form-select !py-1.5 !px-3 text-sm w-full sm:w-auto flex-grow md:flex-grow-0"><option value="all">Todos Tipos</option><option value="free">Grátis</option><option value="paid">Pago</option><option value="both">Grátis/Pago</option></select>
                         <select id="filterSortSelect" class="form-select !py-1.5 !px-3 text-sm w-full sm:w-auto flex-grow md:flex-grow-0"><option value="popular">Populares</option><option value="recent">Recentes</option><option value="rating">Avaliação</option><option value="name_asc">Nome A-Z</option><option value="name_desc">Nome Z-A</option></select>
                     </div>
                     <div class="text-sm text-text-muted whitespace-nowrap w-full md:w-auto text-right md:text-left">
                         <span id="toolsCountSpan" class="font-semibold text-accent">0</span> ferramentas
                     </div>
                </div>
                 <div class="relative">
                    <div id="categoryButtonsContainer" class="flex space-x-2 overflow-x-auto pb-2 -mb-2 scrollbar-thin scrollbar-thumb-primary/50 hover:scrollbar-thumb-primary scrollbar-track-bg-card/50">{/* Populated */}</div>
                    <div class="absolute left-0 top-0 bottom-0 w-6 bg-gradient-to-r from-bg-dark to-transparent pointer-events-none md:hidden"></div>
                    <div class="absolute right-0 top-0 bottom-0 w-6 bg-gradient-to-l from-bg-dark to-transparent pointer-events-none md:hidden"></div>
                 </div>
            </div>
        </section>

        <!-- Main Content Area -->
        <main class="flex-grow container section-padding">
            <section id="featuredSection" class="mb-12 md:mb-16">
                 <div class="flex justify-between items-center section-title">
                    <h3 class="text-2xl md:text-3xl font-bold text-accent flex items-center"><i class="fas fa-star mr-3 text-yellow-400"></i> Destaques</h3>
                 </div>
                 <div id="featuredToolsContainer" class="grid-layout grid-layout-cols">{/* Populated */}</div>
            </section>

             <section id="allToolsSection">
                 <div class="flex justify-between items-center section-title">
                     <h3 id="allToolsTitle" class="text-2xl md:text-3xl font-bold text-text-main flex items-center">Grid de Ferramentas</h3>
                 </div>
                 <div id="listViewContainer" class="list-layout hidden">
                     <div id="listViewToolsContainer"> {/* Cards appended */} </div>
                 </div>
                 <div id="gridViewContainer">
                     <div id="gridViewToolsContainer" class="grid-layout grid-layout-cols"> {/* Cards appended */} </div>
                 </div>
                 <div id="infiniteScrollTrigger" class="h-24 flex items-center justify-center text-center mt-8">
                    <i id="loadingIndicator" class="fas fa-spinner animate-spin text-accent text-3xl hidden"></i>
                    <p id="noMoreToolsMsg" class="text-text-muted hidden">Você chegou ao fim!</p>
                 </div>
             </section>
        </main>

        <!-- Newsletter -->
        <section class="section-padding bg-slate-800">
            <div class="container max-w-4xl">
                 <div class="glassmorphism p-8 md:p-12 text-center"> <!-- Applied glassmorphism -->
                    <i class="fas fa-envelope-open-text text-5xl mb-5 text-accent"></i>
                    <h3 class="text-3xl font-bold mb-3 text-white">Fique por Dentro</h3>
                    <p class="mb-8 text-text-muted max-w-xl mx-auto">Assine nossa newsletter e receba as últimas ferramentas e tendências.</p>
                    <form class="flex flex-col sm:flex-row gap-3 max-w-lg mx-auto" onsubmit="alert('Inscrição simulada! Obrigado.'); return false;">
                        <input type="email" required placeholder="seu.email@provedor.com" class="form-input flex-grow !py-3 !px-4 rounded-lg text-base focus:outline-none w-full">
                        <button type="submit" class="btn btn-accent !px-6 !py-3 rounded-lg font-medium whitespace-nowrap w-full sm:w-auto">Inscrever-se</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-slate-900 text-text-muted border-t border-border-color pt-12 pb-8">
             <div class="container">
                 <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-10">
                     <div class="space-y-4"><h4 class="text-lg font-bold text-text-main flex items-center font-heading"><i class="fas fa-robot mr-2 text-accent"></i> AI Tools Hub</h4><p class="text-sm">Seu portal centralizado para descobrir ferramentas digitais.</p><div class="flex space-x-4 pt-2"><a href="#" aria-label="Facebook" class="hover:text-accent transition text-xl"><i class="fab fa-facebook"></i></a><a href="#" aria-label="Twitter" class="hover:text-accent transition text-xl"><i class="fab fa-twitter"></i></a><a href="#" aria-label="Instagram" class="hover:text-accent transition text-xl"><i class="fab fa-instagram"></i></a><a href="#" aria-label="LinkedIn" class="hover:text-accent transition text-xl"><i class="fab fa-linkedin"></i></a></div></div>
                     <div><h4 class="text-md font-bold mb-4 text-text-main font-heading uppercase tracking-wider">Navegação</h4><ul class="space-y-2 text-sm"><li><a href="#" class="hover:text-accent transition">Início</a></li><li><a href="#allToolsSection" class="hover:text-accent transition">Ferramentas</a></li><li><a href="#featuredSection" class="hover:text-accent transition">Destaques</a></li><li><a href="#categoryButtonsContainer" class="hover:text-accent transition">Categorias</a></li></ul></div>
                     <div><h4 class="text-md font-bold mb-4 text-text-main font-heading uppercase tracking-wider">Suporte</h4><ul class="space-y-2 text-sm"><li><a href="#" class="hover:text-accent transition">FAQ</a></li><li><a href="#" class="hover:text-accent transition">Contato</a></li><li><a href="#" class="hover:text-accent transition">Termos</a></li><li><a href="#" class="hover:text-accent transition">Privacidade</a></li></ul></div>
                     <div><h4 class="text-md font-bold mb-4 text-text-main font-heading uppercase tracking-wider">Sobre</h4><ul class="space-y-2 text-sm"><li><a href="#" class="hover:text-accent transition">Nossa Missão</a></li><li><a href="#" class="hover:text-accent transition">Submeter</a></li><li><a href="#" class="hover:text-accent transition">Parcerias</a></li></ul></div>
                 </div>
                 <div class="border-t border-border-color mt-8 pt-8 text-center text-sm"><p>© <span id="currentYear"></span> AI Tools Hub. Feito com <i class="fas fa-heart text-red-500 mx-1"></i><li><a href="https://www.instagram.com/joaoricardo.pe" class="hover:text-accent transition">João Ricardo</a></p></div>
             </div>
        </footer>
    </div>

    <!-- --- JavaScript --- -->
    <script>
        // --- Constants & Initial Data ---
        const ITEMS_PER_PAGE_GRID = 16;
        const ITEMS_PER_PAGE_LIST = 10;
        // MODIFIED: Added default image URL
        const DEFAULT_IMAGE_URL = 'https://images.unsplash.com/photo-1684369176170-463e84248b70?q=80&w=1684&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D';
        // END MODIFICATION
        const CATEGORIES = [ { id: 'all', name: 'Todas', icon: 'th-large', keywords: 'technology,abstract,future,cyberpunk' }, { id: 'ai', name: 'IA', icon: 'brain', keywords: 'ai,artificial intelligence,machine learning,robot,neural network,data science,generative,nlp' }, { id: 'writing', name: 'Escrita', icon: 'pencil-alt', keywords: 'writing,content,copywriting,text,blog,summarize,grammar,seo,script' }, { id: 'design', name: 'Design', icon: 'palette', keywords: 'design,graphic,ui,ux,illustration,vector,color,image generation,logo,mockup,font,3d,web design' }, { id: 'audio-video', name: 'Áudio & Vídeo', icon: 'film', keywords: 'audio,video,music,podcast,editing,generation,voiceover,sound effects,streaming,animation' }, { id: 'developer', name: 'Dev Tools', icon: 'code', keywords: 'developer,code,programming,api,debug,database,testing,hosting,cloud,low code,no code,git,ci/cd,framework' }, { id: 'productivity', name: 'Produtividade', icon: 'tasks', keywords: 'productivity,tasks,notes,organization,work,collaboration,project management,calendar,automation,mind map,presentation' }, { id: 'automation', name: 'Automação', icon: 'robot', keywords: 'automation,robot,workflow,script,integration,zapier,ifttt,rpa,scraping' }, { id: 'social-media', name: 'Mídia Social', icon: 'share-alt', keywords: 'social media,marketing,schedule,post,analytics,content creation,influencer,community' }, { id: 'ecommerce', name: 'E-commerce', icon: 'shopping-cart', keywords: 'ecommerce,store,shop,sell,online,dropshipping,payments,marketing,crm,logistics' }, { id: 'search', name: 'Busca & Dados', icon: 'search', keywords: 'search,data,research,analytics,business intelligence,market research,trends,osint,knowledge base' }, { id: 'finance', name: 'Finanças', icon: 'chart-pie', keywords: 'finance,money,investing,budget,stock,crypto,accounting,invoice,taxes,banking' }, { id: 'education', name: 'Educação', icon: 'graduation-cap', keywords: 'education,learning,course,study,knowledge,language,tutorial,skill,platform' }, { id: 'utilities', name: 'Utilitários', icon: 'tools', keywords: 'utility,tools,converter,file,system,pdf,screenshot,calculator,units,qr code,timer' }, { id: 'security', name: 'Segurança', icon: 'shield-alt', keywords: 'security,privacy,vpn,password,cybersecurity,antivirus,encryption,authentication,backup' }, { id: 'network', name: 'Redes & Infra', icon: 'network-wired', keywords: 'network,server,cloud,hosting,internet,dns,ip address,devops,monitoring,cdn' }, { id: 'blockchain', name: 'Blockchain', icon: 'link', keywords: 'blockchain,crypto,nft,web3,defi,smart contract,wallet,dao,metaverse' }, { id: 'hacking', name: 'Hacking Ético', icon: 'user-secret', keywords: 'hacking,security,pentest,cybersecurity,osint,forensics,ctf,vulnerability' }, { id: 'games', name: 'Jogos', icon: 'gamepad', keywords: 'game,gaming,fun,entertainment,retro,esports,streaming,development,asset' }, { id: 'health', name: 'Saúde', icon: 'heartbeat', keywords: 'health,wellness,fitness,meditation,mental health,nutrition,telemedicine,wearable' }, { id: 'communication', name: 'Comunicação', icon: 'comments', keywords: 'communication,chat,email,meeting,collaboration,video conference,voip,team' }, { id: 'geolocation', name: 'Geo', icon: 'map-marker-alt', keywords: 'map,geo,location,gps,travel,logistics,gis,routing,visualization' }, { id: 'government', name: 'Governo', icon: 'landmark', keywords: 'government,public service,document,official,legal,taxes,citizen,portal' }, { id: 'data-analysis', name: 'Análise Dados', icon: 'chart-line', keywords: 'data analysis,analytics,chart,visualization,bi,statistics,big data,reporting,dashboard' }, { id: 'others', name: 'Outros', icon: 'ellipsis-h', keywords: 'tool,utility,abstract,various,miscellaneous,cyberpunk,future,experimental,niche' } ];
        let tools = []; // Populated on init by processing your data

        // --- State Variables ---
        const appState = {
            currentView: 'grid', currentPage: 1, itemsPerPage: ITEMS_PER_PAGE_GRID,
            currentFilteredTools: [], isLoading: false, isAdminLoggedIn: false, observer: null
        };

        // --- DOM Element References ---
        const DOMElements = {
            // Modals & Overlays
            loginOverlay: document.getElementById('loginOverlay'), loginForm: document.getElementById('loginForm'), closeLoginBtn: document.getElementById('closeLoginBtn'), loginErrorMsg: document.getElementById('loginErrorMsg'),
            adminToggleBtn: document.getElementById('adminToggleBtn'), adminPanel: document.getElementById('adminPanel'), closeAdminBtn: document.getElementById('closeAdminBtn'),
            // Admin Form
            adminForm: document.getElementById('adminForm'), adminFormTitle: document.getElementById('adminFormTitle'), adminToolIdInput: document.getElementById('adminToolIdInput'), adminToolNameInput: document.getElementById('adminToolNameInput'), adminToolDescInput: document.getElementById('adminToolDescInput'), adminToolCategorySelect: document.getElementById('adminToolCategorySelect'), adminToolTypeSelect: document.getElementById('adminToolTypeSelect'), adminToolUrlInput: document.getElementById('adminToolUrlInput'), adminToolMediaInput: document.getElementById('adminToolMediaInput'), adminToolFeaturedCheckbox: document.getElementById('adminToolFeaturedCheckbox'), adminToolEssentialCheckbox: document.getElementById('adminToolEssentialCheckbox'), adminAddBtn: document.getElementById('adminAddBtn'), adminUpdateBtn: document.getElementById('adminUpdateBtn'), adminCancelEditBtn: document.getElementById('adminCancelEditBtn'),
            // Admin Management
            adminToolsListTbody: document.getElementById('adminToolsListTbody'), adminSearchInput: document.getElementById('adminSearchInput'), adminSearchBtn: document.getElementById('adminSearchBtn'),
            adminExportBtn: document.getElementById('adminExportBtn'), adminImportBtn: document.getElementById('adminImportBtn'),
            adminExportCsvBtn: document.getElementById('adminExportCsvBtn'), // Added
            adminImportCsvBtn: document.getElementById('adminImportCsvBtn'), // Added
            // Main UI
            mobileMenuToggle: document.getElementById('mobileMenuBtn'), mobileMenuContent: document.getElementById('mobileMenuContent'),
            listViewBtn: document.getElementById('listViewBtn'), gridViewBtn: document.getElementById('gridViewBtn'), mobileListViewBtn: document.getElementById('mobileListViewBtn'), mobileGridViewBtn: document.getElementById('mobileGridViewBtn'),
            listViewContainer: document.getElementById('listViewContainer'), gridViewContainer: document.getElementById('gridViewContainer'), listViewToolsContainer: document.getElementById('listViewToolsContainer'), gridViewToolsContainer: document.getElementById('gridViewToolsContainer'),
            featuredToolsContainer: document.getElementById('featuredToolsContainer'), featuredSection: document.getElementById('featuredSection'), allToolsSection: document.getElementById('allToolsSection'), allToolsTitle: document.getElementById('allToolsTitle'),
            // Filters & Search
            mainSearchInput: document.getElementById('mainSearchInput'), mainSearchBtn: document.getElementById('mainSearchBtn'), filterCategorySelect: document.getElementById('filterCategorySelect'), filterTypeSelect: document.getElementById('filterTypeSelect'), filterSortSelect: document.getElementById('filterSortSelect'), categoryButtonsContainer: document.getElementById('categoryButtonsContainer'), toolsCountSpan: document.getElementById('toolsCountSpan'),
            // Stats
            statTotalTools: document.getElementById('statTotalTools'), statTotalCategories: document.getElementById('statTotalCategories'), statFeaturedTools: document.getElementById('statFeaturedTools'), statEssentialTools: document.getElementById('statEssentialTools'),
            // Infinite Scroll
            infiniteScrollTrigger: document.getElementById('infiniteScrollTrigger'), loadingIndicator: document.getElementById('loadingIndicator'), noMoreToolsMsg: document.getElementById('noMoreToolsMsg'),
            // Footer
            currentYearSpan: document.getElementById('currentYear'),
            // Language (placeholders)
            languageMenuBtn: document.getElementById('languageMenuBtn'), languageDropdown: document.getElementById('languageDropdown'), mobileLanguageMenuBtn: document.getElementById('mobileLanguageMenuBtn'), mobileLanguageDropdown: document.getElementById('mobileLanguageDropdown')
        };

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            try {
                DOMElements.currentYearSpan.textContent = new Date().getFullYear();
                processAndSetToolsData(); // <= Use your data here
                populateCategoryFilters();
                renderCategoryButtons();
                setupEventListeners();
                setupLogin();
                setupAdminPanel();
                updateStats();
                setView(appState.currentView); // Initial view setup
                renderFeaturedTools();
                filterAndRenderTools(true); // <= Initial render after data setup
                setupIntersectionObserver(); // <= Setup observer after initial render
                console.log("AI Tools Hub Initialized Successfully with User Data.");
            } catch (error) {
                console.error("Initialization failed:", error);
                document.body.innerHTML = '<div style="color: white; padding: 20px; text-align: center;">Oops! Something went wrong during initialization. Please check the console for details.</div>';
            }
        });


        // --- Event Listener Setup ---
        function setupEventListeners() {
            // View Toggles
            DOMElements.listViewBtn?.addEventListener('click', () => setView('list'));
            DOMElements.gridViewBtn?.addEventListener('click', () => setView('grid'));
            DOMElements.mobileListViewBtn?.addEventListener('click', () => { setView('list'); hideMobileMenu(); });
            DOMElements.mobileGridViewBtn?.addEventListener('click', () => { setView('grid'); hideMobileMenu(); });
            // Mobile Menu
            DOMElements.mobileMenuToggle?.addEventListener('click', toggleMobileMenu);
            // Filters & Search
            DOMElements.filterCategorySelect?.addEventListener('change', handleFilterChange);
            DOMElements.filterTypeSelect?.addEventListener('change', handleFilterChange);
            DOMElements.filterSortSelect?.addEventListener('change', handleFilterChange);
            DOMElements.mainSearchBtn?.addEventListener('click', handleFilterChange);
            DOMElements.mainSearchInput?.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleFilterChange(e); }); // Pass event
            // Admin Toggle
            DOMElements.adminToggleBtn?.addEventListener('click', () => { appState.isAdminLoggedIn ? showAdminPanel() : showLoginOverlay(); });
            // Language Dropdowns (Placeholder)
            DOMElements.languageMenuBtn?.addEventListener('click', () => DOMElements.languageDropdown?.classList.toggle('hidden'));
            DOMElements.mobileLanguageMenuBtn?.addEventListener('click', () => DOMElements.mobileLanguageDropdown?.classList.toggle('hidden'));
            // Global Click Listener (for closing dropdowns/menus)
            document.addEventListener('click', (event) => {
                if (!DOMElements.languageMenuBtn?.contains(event.target) && !DOMElements.languageDropdown?.contains(event.target)) DOMElements.languageDropdown?.classList.add('hidden');
                if (!DOMElements.mobileLanguageMenuBtn?.contains(event.target) && !DOMElements.mobileLanguageDropdown?.contains(event.target)) DOMElements.mobileLanguageDropdown?.classList.add('hidden');
                // Close mobile menu if click is outside toggle button AND menu content
                if (DOMElements.mobileMenuToggle && DOMElements.mobileMenuContent && !DOMElements.mobileMenuToggle.contains(event.target) && !DOMElements.mobileMenuContent.contains(event.target)) {
                   hideMobileMenu();
                }
            });
        }

        // --- Core Logic: Filtering, Rendering, View Switching ---
        function handleFilterChange(event) { // Accept event parameter
            appState.currentPage = 1; appState.isLoading = false;
            DOMElements.noMoreToolsMsg?.classList.add('hidden');
            if (appState.observer) appState.observer.disconnect();
            filterAndRenderTools(true);
            // Sync category button only if dropdown changed
            if (event?.target === DOMElements.filterCategorySelect) {
                updateActiveCategoryButton(DOMElements.filterCategorySelect.value);
            }
             // Re-setup observer after filtering and rendering
             // Small delay to ensure DOM updates are likely complete
            setTimeout(setupIntersectionObserver, 100);
        }

        function setView(view) {
            if (view === appState.currentView) return;
            appState.currentView = view; appState.itemsPerPage = (view === 'list') ? ITEMS_PER_PAGE_LIST : ITEMS_PER_PAGE_GRID;
            appState.currentPage = 1; appState.isLoading = false; DOMElements.noMoreToolsMsg?.classList.add('hidden');
            if (appState.observer) appState.observer.disconnect();
            // UI updates
            const listBtns = [DOMElements.listViewBtn, DOMElements.mobileListViewBtn], gridBtns = [DOMElements.gridViewBtn, DOMElements.mobileGridViewBtn];
            const listCont = [DOMElements.listViewContainer], gridCont = [DOMElements.gridViewContainer];
            if (view === 'list') { activateElements(listBtns); deactivateElements(gridBtns); showElements(listCont); hideElements(gridCont); DOMElements.allToolsTitle.innerHTML = `<i class="fas fa-list mr-3 text-accent"></i> Lista de Ferramentas`; }
            else { activateElements(gridBtns); deactivateElements(listBtns); showElements(gridCont); hideElements(listCont); DOMElements.allToolsTitle.innerHTML = `<i class="fas fa-th-large mr-3 text-accent"></i> Grid de Ferramentas`; }
            filterAndRenderTools(true);
            // Re-setup observer after view switch and rendering
            // Small delay to ensure DOM updates are likely complete
            setTimeout(setupIntersectionObserver, 100);
        }

        function filterToolsData() {
            const catVal = DOMElements.filterCategorySelect.value, typeVal = DOMElements.filterTypeSelect.value, sortVal = DOMElements.filterSortSelect.value, searchVal = DOMElements.mainSearchInput.value.toLowerCase().trim();
            let filtered = tools.filter(t => {
                const catInfo = CATEGORIES.find(c => c.id === t.category);
                const catName = catInfo?.name || ''; // Get the Portuguese name for searching
                const searchMatch = searchVal === '' || (t.name || '').toLowerCase().includes(searchVal) || (t.description || '').toLowerCase().includes(searchVal) || catName.toLowerCase().includes(searchVal) || (t.category || '').toLowerCase().includes(searchVal); // Search category name or ID
                const catMatch = catVal === 'all' || t.category === catVal;
                const typeMatch = typeVal === 'all' || t.type === typeVal;
                return searchMatch && catMatch && typeMatch;
            });
            switch (sortVal) { case 'popular': filtered.sort((a, b) => (b.rating || 0) - (a.rating || 0)); break; case 'recent': filtered.sort((a, b) => new Date(b.dateAdded || 0) - new Date(a.dateAdded || 0)); break; case 'rating': filtered.sort((a, b) => (b.rating || 0) - (a.rating || 0)); break; case 'name_asc': filtered.sort((a, b) => (a.name || '').localeCompare(b.name || '')); break; case 'name_desc': filtered.sort((a, b) => (b.name || '').localeCompare(a.name || '')); break; }
            appState.currentFilteredTools = filtered; updateToolsCount(filtered.length);
        }

        function filterAndRenderTools(isInitialRender = false) { filterToolsData(); renderToolsPage(isInitialRender); }

        function renderToolsPage(isInitialRender = false) {
             const startIndex = (appState.currentPage - 1) * appState.itemsPerPage;
             const endIndex = startIndex + appState.itemsPerPage;
             const toolsToDisplay = appState.currentFilteredTools.slice(startIndex, endIndex);
             const targetContainer = (appState.currentView === 'list') ? DOMElements.listViewToolsContainer : DOMElements.gridViewToolsContainer;
             const cardCreator = (appState.currentView === 'list') ? createListToolCard : createToolCard;

             if (isInitialRender && targetContainer) targetContainer.innerHTML = '';

             if (appState.currentFilteredTools.length === 0 && isInitialRender) {
                 if(targetContainer) targetContainer.innerHTML = `<p class="text-center text-text-muted col-span-full py-10">Nenhuma ferramenta encontrada.</p>`;
                 DOMElements.noMoreToolsMsg?.classList.remove('hidden'); DOMElements.loadingIndicator?.classList.add('hidden');
                 if (appState.observer) appState.observer.disconnect(); return;
             }

             const fragment = document.createDocumentFragment();
             toolsToDisplay.forEach((tool, index) => { const el = cardCreator(tool); el.style.animationDelay = `${(index % appState.itemsPerPage) * 0.04}s`; el.classList.add('animate-fadeIn'); fragment.appendChild(el); });
             targetContainer?.appendChild(fragment); // Append only if container exists

             appState.isLoading = false; DOMElements.loadingIndicator?.classList.add('hidden');

             // Check if more items exist AFTER rendering the current page
             const hasMoreItems = (appState.currentPage * appState.itemsPerPage) < appState.currentFilteredTools.length;

             if (!hasMoreItems) {
                 DOMElements.noMoreToolsMsg?.classList.remove('hidden');
                 if (appState.observer) appState.observer.disconnect();
             } else {
                 DOMElements.noMoreToolsMsg?.classList.add('hidden');
                 // Ensure observer is watching if it exists and we're not already at the end
                 if (appState.observer && DOMElements.infiniteScrollTrigger) {
                     appState.observer.observe(DOMElements.infiniteScrollTrigger);
                 }
             }
        }

        // --- Infinite Scroll ---
        function setupIntersectionObserver() {
            if (appState.observer) appState.observer.disconnect(); // Disconnect previous observer first
            if (!DOMElements.infiniteScrollTrigger) return; // Exit if trigger doesn't exist

            const hasMoreItems = (appState.currentPage * appState.itemsPerPage) < appState.currentFilteredTools.length;

            if (!hasMoreItems) {
                if (appState.currentFilteredTools.length > 0) DOMElements.noMoreToolsMsg?.classList.remove('hidden');
                DOMElements.loadingIndicator?.classList.add('hidden');
                return; // No more items, don't setup observer
            } else {
                 DOMElements.noMoreToolsMsg?.classList.add('hidden'); // Hide if previously shown
            }

            const options = { root: null, rootMargin: '0px 0px 300px 0px', threshold: 0 };
            try {
                appState.observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting && !appState.isLoading) {
                            // Double check if there are still more items
                             const stillMoreItems = (appState.currentPage * appState.itemsPerPage) < appState.currentFilteredTools.length;
                            if (stillMoreItems) {
                                loadMoreItems();
                            } else {
                                DOMElements.noMoreToolsMsg?.classList.remove('hidden');
                                DOMElements.loadingIndicator?.classList.add('hidden');
                                if (appState.observer) {
                                    appState.observer.unobserve(DOMElements.infiniteScrollTrigger); // Stop observing
                                    appState.observer.disconnect(); // Fully disconnect
                                    appState.observer = null; // Clear observer reference
                                }
                            }
                        }
                    });
                }, options);
                appState.observer.observe(DOMElements.infiniteScrollTrigger);
            } catch (error) {
                console.error("Failed to setup IntersectionObserver:", error);
            }
        }

        function loadMoreItems() {
            if (appState.isLoading) return;
            appState.isLoading = true;
            DOMElements.loadingIndicator?.classList.remove('hidden');
            DOMElements.noMoreToolsMsg?.classList.add('hidden');
            // Simulate network delay for loading effect
            setTimeout(() => {
                appState.currentPage++;
                renderToolsPage(false); // Render the next page, false indicates not an initial render
                 // isLoading is set back to false inside renderToolsPage
            }, 300);
        }

        // --- Login / Admin Access Control ---
        function setupLogin() {
             if(DOMElements.loginForm) DOMElements.loginForm.addEventListener('submit', handleLoginAttempt);
             if(DOMElements.closeLoginBtn) DOMElements.closeLoginBtn.addEventListener('click', hideLoginOverlay);
        }
        function handleLoginAttempt(e) { e.preventDefault(); const u = DOMElements.loginForm.username.value, p = DOMElements.loginForm.password.value; if (u === 'admin' && p === '123456') { appState.isAdminLoggedIn = true; DOMElements.loginErrorMsg?.classList.add('hidden'); hideLoginOverlay(); showAdminPanel(); } else { appState.isAdminLoggedIn = false; DOMElements.loginErrorMsg?.classList.remove('hidden'); DOMElements.loginForm.parentElement?.classList.add('animate-shake'); setTimeout(() => DOMElements.loginForm.parentElement?.classList.remove('animate-shake'), 500); } }
        function showLoginOverlay() { DOMElements.loginOverlay?.classList.remove('hidden'); document.body.style.overflow = 'hidden'; DOMElements.loginForm?.username.focus(); }
        function hideLoginOverlay() { DOMElements.loginOverlay?.classList.add('hidden'); if (!DOMElements.adminPanel?.classList.contains('flex')) { document.body.style.overflow = ''; } DOMElements.loginErrorMsg?.classList.add('hidden'); }
        function showAdminPanel() { if (!appState.isAdminLoggedIn) { showLoginOverlay(); return; } DOMElements.adminPanel?.classList.remove('hidden'); DOMElements.adminPanel?.classList.add('flex'); document.body.style.overflow = 'hidden'; renderAdminToolsList(); }
        function hideAdminPanel() { DOMElements.adminPanel?.classList.add('hidden'); DOMElements.adminPanel?.classList.remove('flex'); document.body.style.overflow = ''; resetAdminForm(); }

        // --- Admin Panel Logic ---
        function setupAdminPanel() {
            if(DOMElements.adminForm) DOMElements.adminForm.addEventListener('submit', handleAdminFormSubmit);
            if(DOMElements.adminCancelEditBtn) DOMElements.adminCancelEditBtn.addEventListener('click', resetAdminForm);
            if(DOMElements.adminSearchBtn) DOMElements.adminSearchBtn.addEventListener('click', searchAdminTools);
            if(DOMElements.adminSearchInput) DOMElements.adminSearchInput.addEventListener('keyup', (e) => { if (e.key === 'Enter' || DOMElements.adminSearchInput.value.length === 0 || DOMElements.adminSearchInput.value.length > 1) searchAdminTools(); });
            // MODIFIED: Add listeners for CSV buttons
            if(DOMElements.adminExportBtn) DOMElements.adminExportBtn.addEventListener('click', exportToolsData);
            if(DOMElements.adminImportBtn) DOMElements.adminImportBtn.addEventListener('click', importToolsData);
            if(DOMElements.adminExportCsvBtn) DOMElements.adminExportCsvBtn.addEventListener('click', exportToolsCSV); // Added
            if(DOMElements.adminImportCsvBtn) DOMElements.adminImportCsvBtn.addEventListener('click', importToolsCSV); // Added
            // END MODIFICATION
            if(DOMElements.closeAdminBtn) DOMElements.closeAdminBtn.addEventListener('click', hideAdminPanel);
        }

        function handleAdminFormSubmit(e) {
             e.preventDefault(); const id = parseInt(DOMElements.adminToolIdInput.value);
             const fd = { name: DOMElements.adminToolNameInput.value, description: DOMElements.adminToolDescInput.value, category: DOMElements.adminToolCategorySelect.value, type: DOMElements.adminToolTypeSelect.value, url: DOMElements.adminToolUrlInput.value, media: DOMElements.adminToolMediaInput.value || null, // Store null if empty
                 featured: DOMElements.adminToolFeaturedCheckbox.checked, essential: DOMElements.adminToolEssentialCheckbox.checked, };
             if (!fd.name || !fd.description || !fd.url) { alert('Nome, Descrição e URL obrigatórios.'); return; }
             try {
                 // Media logic now handled primarily in card creation
                 if (id) { const idx = tools.findIndex(t => t.id === id); if (idx > -1) { tools[idx] = { ...tools[idx], ...fd }; alert('Atualizado!'); } else { alert('Erro: Não encontrado.'); } }
                 else { const nt = { id: tools.length > 0 ? Math.max(...tools.map(t => t.id)) + 1 : 1, ...fd, rating: randomRating(), dateAdded: new Date().toISOString().split('T')[0], badge: 'Novo', }; tools.unshift(nt); alert('Adicionado!'); }
                 resetAdminForm(); appState.currentPage = 1; if (appState.observer) appState.observer.disconnect();
                 filterAndRenderTools(true); renderFeaturedTools(); renderAdminToolsList(); updateStats(); setupIntersectionObserver();
             } catch (error) {
                 console.error("Error adding/updating tool:", error);
                 alert("Ocorreu um erro ao salvar a ferramenta.");
             }
        }
        function resetAdminForm() { DOMElements.adminForm?.reset(); DOMElements.adminToolIdInput.value = ''; DOMElements.adminAddBtn?.classList.remove('hidden'); DOMElements.adminUpdateBtn?.classList.add('hidden'); DOMElements.adminCancelEditBtn?.classList.add('hidden'); DOMElements.adminFormTitle.textContent = 'Adicionar Nova Ferramenta'; }
        function handleEditTool(e) { const id = parseInt(e.currentTarget.dataset.id); const t = tools.find(x => x.id === id); if (!t) { console.error("Tool not found:", id); return; } DOMElements.adminToolIdInput.value = t.id; DOMElements.adminToolNameInput.value = t.name || ''; DOMElements.adminToolDescInput.value = t.description || ''; DOMElements.adminToolCategorySelect.value = t.category || ''; DOMElements.adminToolTypeSelect.value = t.type || 'free'; DOMElements.adminToolMediaInput.value = t.media || ''; DOMElements.adminToolUrlInput.value = t.url || ''; DOMElements.adminToolFeaturedCheckbox.checked = t.featured || false; DOMElements.adminToolEssentialCheckbox.checked = t.essential || false; DOMElements.adminAddBtn?.classList.add('hidden'); DOMElements.adminUpdateBtn?.classList.remove('hidden'); DOMElements.adminCancelEditBtn?.classList.remove('hidden'); DOMElements.adminFormTitle.textContent = 'Editar Ferramenta'; DOMElements.adminForm?.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
        function searchAdminTools() { const s = DOMElements.adminSearchInput.value.toLowerCase(); const f = tools.filter(t => (t.name||'').toLowerCase().includes(s) || (t.description||'').toLowerCase().includes(s)); renderAdminToolsList(f); }

        // --- JSON Export / Import ---
        function exportToolsData() { try { const d = JSON.stringify(tools, null, 2); const b = new Blob([d], {type: "application/json"}); const u = URL.createObjectURL(b); const l = document.createElement('a'); l.href = u; l.download = `aitoolshub_export_${new Date().toISOString().split('T')[0]}.json`; document.body.appendChild(l); l.click(); document.body.removeChild(l); URL.revokeObjectURL(u); } catch (e) { console.error("Export failed:", e); alert("Falha ao exportar JSON."); } }
        function importToolsData() { const i = document.createElement('input'); i.type = 'file'; i.accept = '.json,application/json'; i.onchange = e => { const f = e.target.files[0]; if (!f) return; const r = new FileReader(); r.onload = ev => { try { const d = JSON.parse(ev.target.result); if (Array.isArray(d) && d.length > 0 && 'id' in d[0] && 'name' in d[0]) { if (confirm(`Importar ${d.length} ferramentas do JSON? (Substituirá as atuais)`)) { tools = d; appState.currentPage = 1; DOMElements.filterCategorySelect.value = 'all'; DOMElements.filterTypeSelect.value = 'all'; DOMElements.filterSortSelect.value = 'popular'; DOMElements.mainSearchInput.value = ''; if (appState.observer) appState.observer.disconnect(); filterAndRenderTools(true); renderFeaturedTools(); renderCategoryButtons(); renderAdminToolsList(); updateStats(); setupIntersectionObserver(); alert('JSON Importado!'); } } else { alert('JSON inválido.'); } } catch (err) { console.error("Import failed:", err); alert('Erro ao ler JSON.'); } }; r.onerror = () => alert('Erro ao ler arquivo.'); r.readAsText(f); }; i.click(); }

        // --- NEW: CSV Export / Import ---
        function escapeCsvValue(value) {
            if (value === null || typeof value === 'undefined') {
                return '';
            }
            const stringValue = String(value);
            // If the value contains a comma, newline, or double quote, enclose it in double quotes
            if (stringValue.includes(',') || stringValue.includes('\n') || stringValue.includes('"')) {
                // Escape existing double quotes by doubling them
                const escapedValue = stringValue.replace(/"/g, '""');
                return `"${escapedValue}"`;
            }
            return stringValue;
        }

        function exportToolsCSV() {
            try {
                const headers = ['id', 'name', 'description', 'categoryName', 'categoryID', 'type', 'url', 'media', 'rating', 'dateAdded', 'featured', 'essential', 'badge'];
                // Create a map for faster category name lookup
                const categoryMap = CATEGORIES.reduce((acc, cat) => {
                    acc[cat.id] = cat.name;
                    return acc;
                }, {});

                const csvRows = [headers.join(',')]; // Header row

                tools.forEach(tool => {
                    const categoryName = categoryMap[tool.category] || tool.category; // Use name if found, else ID
                    const row = [
                        tool.id,
                        tool.name,
                        tool.description,
                        categoryName, // Export Portuguese name for readability
                        tool.category, // Also export ID for easier import matching
                        tool.type,
                        tool.url,
                        tool.media, // Export media URL (can be null/empty)
                        tool.rating,
                        tool.dateAdded,
                        tool.featured ? 'TRUE' : 'FALSE',
                        tool.essential ? 'TRUE' : 'FALSE',
                        tool.badge
                    ].map(escapeCsvValue); // Escape each value
                    csvRows.push(row.join(','));
                });

                const csvString = csvRows.join('\n');
                const blob = new Blob([`\uFEFF${csvString}`], { type: 'text/csv;charset=utf-8;' }); // Add BOM for Excel compatibility
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `aitoolshub_export_${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

            } catch (e) {
                console.error("CSV Export failed:", e);
                alert("Falha ao exportar CSV.");
            }
        }

        // Basic CSV row parser (handles quoted fields with commas and escaped quotes "" within quoted fields)
        function parseCsvRow(rowString) {
            const values = [];
            let currentVal = '';
            let inQuotes = false;
            for (let i = 0; i < rowString.length; i++) {
                const char = rowString[i];
                const nextChar = rowString[i + 1];

                if (char === '"') {
                    if (inQuotes && nextChar === '"') { // Handle escaped quote ""
                        currentVal += '"';
                        i++; // Skip next quote
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    values.push(currentVal.trim());
                    currentVal = '';
                } else {
                    currentVal += char;
                }
            }
            values.push(currentVal.trim()); // Add the last value
            return values;
        }


        function importToolsCSV() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv,text/csv';
            input.onchange = e => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();

                reader.onload = ev => {
                    try {
                        const csvContent = ev.target.result;
                        const lines = csvContent.split(/\r?\n/).filter(line => line.trim() !== ''); // Split lines and remove empty ones

                        if (lines.length < 2) {
                            alert('Arquivo CSV vazio ou inválido (precisa de cabeçalho e pelo menos uma linha de dados).');
                            return;
                        }

                         const rawHeaders = parseCsvRow(lines[0]); // Parse header row correctly
                         const headers = rawHeaders.map(h => h.trim().toLowerCase()); // Use lowercase headers

                        const importedTools = [];

                        // Create a map for category ID lookup (name -> id)
                        const categoryNameToIdMap = CATEGORIES.reduce((acc, cat) => {
                            acc[cat.name.toLowerCase()] = cat.id;
                            return acc;
                        }, {});

                        // Find indices of required and optional columns
                        const idIndex = headers.indexOf('id');
                        const nameIndex = headers.indexOf('name');
                        const descIndex = headers.indexOf('description');
                        const catNameIndex = headers.indexOf('categoryname'); // Try Portuguese name first
                        const catIdIndex = headers.indexOf('categoryid'); // Fallback to ID
                        const typeIndex = headers.indexOf('type');
                        const urlIndex = headers.indexOf('url');
                        const mediaIndex = headers.indexOf('media');
                        const ratingIndex = headers.indexOf('rating');
                        const dateAddedIndex = headers.indexOf('dateadded');
                        const featuredIndex = headers.indexOf('featured');
                        const essentialIndex = headers.indexOf('essential');
                        const badgeIndex = headers.indexOf('badge');


                        if (idIndex === -1 || nameIndex === -1 || urlIndex === -1 ) {
                             alert('Arquivo CSV inválido. Colunas obrigatórias ausentes: id, name, url.');
                             return;
                        }

                        for (let i = 1; i < lines.length; i++) {
                             const values = parseCsvRow(lines[i]); // Use parser for data rows too
                             if (values.length < headers.length) {
                                console.warn(`Linha ${i+1} ignorada: número de colunas (${values.length}) menor que cabeçalhos (${headers.length}). Conteúdo: ${lines[i]}`);
                                continue; // Skip rows with fewer columns than headers
                             }

                            let category = 'others'; // Default category
                            // Try matching by Name first, then by ID
                             const categoryName = catNameIndex > -1 ? values[catNameIndex]?.trim().toLowerCase() : null;
                             const categoryIdFromCsv = catIdIndex > -1 ? values[catIdIndex]?.trim().toLowerCase() : null;

                             if (categoryName && categoryNameToIdMap[categoryName]) {
                                 category = categoryNameToIdMap[categoryName];
                             } else if (categoryIdFromCsv && CATEGORIES.some(c => c.id === categoryIdFromCsv)) {
                                 category = categoryIdFromCsv;
                             } else if (categoryName || categoryIdFromCsv) {
                                 console.warn(`Categoria '${values[catNameIndex] || values[catIdIndex]}' na linha ${i+1} não encontrada. Usando 'others'.`);
                             }

                             // Handle potentially null/empty media field
                             const mediaValue = mediaIndex > -1 ? (values[mediaIndex] || null) : null;

                             const tool = {
                                id: parseInt(values[idIndex], 10),
                                name: values[nameIndex] || `Ferramenta ${i}`,
                                description: descIndex > -1 ? values[descIndex] : '',
                                category: category,
                                type: typeIndex > -1 ? values[typeIndex]?.toLowerCase() || 'free' : 'free',
                                url: values[urlIndex] || '#',
                                media: mediaValue, // Assign potentially null media
                                rating: ratingIndex > -1 ? parseFloat(values[ratingIndex]) || randomRating() : randomRating(),
                                dateAdded: dateAddedIndex > -1 ? values[dateAddedIndex] || randomDate() : randomDate(),
                                featured: featuredIndex > -1 ? values[featuredIndex]?.toUpperCase() === 'TRUE' : false,
                                essential: essentialIndex > -1 ? values[essentialIndex]?.toUpperCase() === 'TRUE' : false,
                                badge: badgeIndex > -1 ? values[badgeIndex] || null : null,
                             };

                            // Basic validation
                            if (isNaN(tool.id) || !tool.name || !(tool.url && tool.url.startsWith('http'))) { // Ensure URL is valid
                                console.warn(`Linha ${i+1} ignorada: dados inválidos (ID, Nome ou URL inválido/ausente). ID: ${values[idIndex]}, Nome: ${values[nameIndex]}, URL: ${values[urlIndex]}`);
                                continue;
                            }

                            importedTools.push(tool);
                        }

                        if (importedTools.length > 0) {
                            if (confirm(`Importar ${importedTools.length} ferramentas do CSV? (Substituirá as atuais)`)) {
                                // --- Apply imported data and refresh UI ---
                                tools = importedTools;
                                appState.currentPage = 1;
                                DOMElements.filterCategorySelect.value = 'all';
                                DOMElements.filterTypeSelect.value = 'all';
                                DOMElements.filterSortSelect.value = 'popular';
                                DOMElements.mainSearchInput.value = '';
                                if (appState.observer) appState.observer.disconnect();
                                filterAndRenderTools(true);
                                renderFeaturedTools();
                                renderCategoryButtons(); // Ensure buttons reflect potentially new categories if map updated
                                renderAdminToolsList();
                                updateStats();
                                setupIntersectionObserver();
                                alert(`${importedTools.length} ferramentas importadas com sucesso via CSV!`);
                            }
                        } else {
                             alert('Nenhuma ferramenta válida encontrada no arquivo CSV.');
                        }

                    } catch (err) {
                        console.error("CSV Import failed:", err);
                        alert('Erro ao ler ou processar o arquivo CSV. Verifique o formato e o console para detalhes.');
                    }
                };

                reader.onerror = () => {
                    alert('Erro ao ler o arquivo.');
                };

                reader.readAsText(file, 'UTF-8'); // Specify UTF-8 encoding
            };
            input.click();
        }
        // --- END NEW CSV ---


        // --- Admin List Rendering & Actions ---
        function renderAdminToolsList(filtered = null) { const tbody = DOMElements.adminToolsListTbody; if (!tbody) {console.error("Admin Tools List Tbody not found"); return;} tbody.innerHTML = ''; const data = (filtered || tools).sort((a, b) => (a.name || '').localeCompare(b.name || '')); if (data.length === 0) { tbody.innerHTML = '<tr><td colspan="2" class="text-center py-4 text-text-muted">Nenhuma ferramenta.</td></tr>'; return; } const frag = document.createDocumentFragment(); data.forEach(t => { const row = document.createElement('tr'); row.className = 'hover:bg-bg-card-hover transition-colors'; row.innerHTML = `<td>${t.name || 'Sem nome'}</td><td class="actions"><button class="btn btn-secondary btn-sm btn-icon edit-tool" data-id="${t.id}" title="Editar"><i class="fas fa-edit !mr-0"></i></button><button class="btn btn-danger btn-sm btn-icon delete-tool" data-id="${t.id}" title="Excluir"><i class="fas fa-trash !mr-0"></i></button></td>`; frag.appendChild(row); }); tbody.appendChild(frag); attachAdminListActionListeners(); }
        function attachAdminListActionListeners() {
            const tbody = DOMElements.adminToolsListTbody; if (!tbody) return;
             // Use event delegation on the tbody for better performance and dynamic updates
             tbody.addEventListener('click', function(event) {
                const target = event.target.closest('button'); // Find the closest button clicked
                if (!target) return; // Exit if click wasn't on a button or its icon

                const toolId = parseInt(target.dataset.id);

                if (target.classList.contains('delete-tool')) {
                    handleDeleteTool(toolId);
                } else if (target.classList.contains('edit-tool')) {
                    // We pass the event object to handleEditTool now for consistency,
                    // although it might not strictly need it, it's good practice.
                    handleEditTool(event);
                }
            });
        }

        // Modified handleDeleteTool to accept just the ID
        function handleDeleteTool(id) {
             const t = tools.find(x => x.id === id);
             if (confirm(`Excluir "${t?.name || id}"?`)) {
                 tools = tools.filter(x => x.id !== id);
                 appState.currentPage = 1;
                 if (appState.observer) appState.observer.disconnect();
                 filterAndRenderTools(true);
                 renderFeaturedTools();
                 renderAdminToolsList();
                 updateStats();
                 setupIntersectionObserver(); // Re-setup observer after deletion
             }
        }

        // --- UI & Data Population Helpers ---
        function populateCategoryFilters() { DOMElements.filterCategorySelect.innerHTML = '<option value="all">Todas Categorias</option>'; DOMElements.adminToolCategorySelect.innerHTML = ''; CATEGORIES.forEach(c => { if (c.id !== 'all') { const o = document.createElement('option'); o.value = c.id; o.textContent = c.name; DOMElements.filterCategorySelect.appendChild(o.cloneNode(true)); DOMElements.adminToolCategorySelect.appendChild(o); } }); }
        function renderCategoryButtons() { const c = DOMElements.categoryButtonsContainer; if (!c) return; c.innerHTML = ''; CATEGORIES.forEach(cat => { const b = document.createElement('button'); b.className = 'category-button'; b.dataset.categoryId = cat.id; b.innerHTML = `<i class="fas fa-${cat.icon}"></i><span>${cat.name}</span>`; b.addEventListener('click', () => handleCategoryButtonClick(cat.id)); c.appendChild(b); }); updateActiveCategoryButton('all'); }
        function handleCategoryButtonClick(catId) { DOMElements.filterCategorySelect.value = catId; handleFilterChange(); updateActiveCategoryButton(catId); const btn = DOMElements.categoryButtonsContainer.querySelector(`[data-category-id="${catId}"]`); btn?.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' }); }
        function updateActiveCategoryButton(activeCatId) { DOMElements.categoryButtonsContainer?.querySelectorAll('.category-button').forEach(b => { b.classList.toggle('active', b.dataset.categoryId === activeCatId); }); }
        function renderFeaturedTools() { const c = DOMElements.featuredToolsContainer; if (!c) return; c.innerHTML = ''; const f = tools.filter(t => t.featured).slice(0, 4); DOMElements.featuredSection?.classList.toggle('hidden', f.length === 0); const frag = document.createDocumentFragment(); f.forEach((t, i) => { const card = createToolCard(t); card.style.animationDelay = `${i * 0.08}s`; card.classList.add('animate-fadeIn'); frag.appendChild(card); }); c.appendChild(frag); }
        function updateStats() { DOMElements.statTotalTools.textContent = tools.length; DOMElements.statTotalCategories.textContent = CATEGORIES.length - 1; DOMElements.statFeaturedTools.textContent = tools.filter(t => t.featured).length; DOMElements.statEssentialTools.textContent = tools.filter(t => t.essential).length; }
        function updateToolsCount(count) { DOMElements.toolsCountSpan.textContent = count; }

        // --- Mobile Menu Helpers ---
        function toggleMobileMenu() { DOMElements.mobileMenuContent?.classList.toggle('hidden'); }
        function hideMobileMenu() { DOMElements.mobileMenuContent?.classList.add('hidden'); }

        // --- General Helpers ---
        const randomRating = () => (Math.random() * (5.0 - 3.5) + 3.5).toFixed(1);
        const randomDate = () => { const e = new Date(), s = new Date(); s.setFullYear(s.getFullYear() - 3); const d = new Date(s.getTime() + Math.random() * (e.getTime() - s.getTime())); return d.toISOString().split('T')[0]; };
        // Removed getMediaUrl function as default is handled directly in card functions now
        function activateElements(els) { els.forEach(el => el?.classList.add('active', 'bg-primary', 'text-white', 'border-primary')); els.forEach(el => el?.classList.remove('bg-secondary', 'text-text-muted', 'border-border-color')); } // Adjusted to remove secondary styles
        function deactivateElements(els) { els.forEach(el => el?.classList.remove('active', 'bg-primary', 'text-white', 'border-primary')); els.forEach(el => el?.classList.add('bg-secondary', 'text-text-muted', 'border-border-color')); } // Adjusted to add secondary styles
        function showElements(els) { els.forEach(el => el?.classList.remove('hidden')); } function hideElements(els) { els.forEach(el => el?.classList.add('hidden')); }

        // --- Data Processing for User's Input ---
        function processAndSetToolsData() {
            const inputData = [
                { "ID": 1, "Título": "DeepSeek Chat", "Descrição": "Assistente de IA para comunicação inteligente", "Categoria": "Inteligência Artificial", "Tipo": "free", "Link": "https://chat.deepseek.com/" },
                { "ID": 2, "Título": "Ilovepdf", "Descrição": "Ferramentas online para edição e conversão de PDF", "Categoria": "Utilitários", "Tipo": "both", "Link": "https://www.ilovepdf.com/" },
                { "ID": 3, "Título": "Coolors", "Descrição": "Gerador e explorador de paletas de cores para designers", "Categoria": "Design", "Tipo": "free", "Link": "https://coolors.co/" },
                { "ID": 4, "Título": "MacroRecorder", "Descrição": "Grava e reproduz macros para automatizar cliques e teclas", "Categoria": "Automação", "Tipo": "both", "Link": "https://macrorecorder.com/" },
                { "ID": 5, "Título": "MyAbandonware", "Descrição": "Jogos clássicos abandonados disponíveis para download legal", "Categoria": "Jogos", "Tipo": "free", "Link": "https://www.myabandonware.com/" },
                { "ID": 6, "Título": "SR Watson", "Descrição": "Consulta de CNPJ e investigação empresarial dinâmica", "Categoria": "Consultas e Buscas", "Tipo": "both", "Link": "https://srwatson.io/" },
                { "ID": 7, "Título": "Ocenaudio", "Descrição": "Editor de áudio simples e eficiente para edição básica", "Categoria": "Áudio e Vídeo", "Tipo": "free", "Link": "https://www.ocenaudio.com/" },
                { "ID": 8, "Título": "Kdenlive", "Descrição": "Editor de vídeo open-source e multiplataforma", "Categoria": "Áudio e Vídeo", "Tipo": "free", "Link": "https://kdenlive.org/" },
                { "ID": 9, "Título": "Vdo.ninja", "Descrição": "Ferramenta para captura e transmissão de vídeo em tempo real", "Categoria": "Áudio e Vídeo", "Tipo": "free", "Link": "https://vdo.ninja/" },
                { "ID": 10, "Título": "Audiomass", "Descrição": "Editor de áudio online com recursos avançados", "Categoria": "Áudio e Vídeo", "Tipo": "free", "Link": "https://audiomass.co/" },
                { "ID": 11, "Título": "Radio Garden", "Descrição": "Explore rádios ao vivo de todo o mundo em um globo interativo", "Categoria": "Áudio e Vídeo", "Tipo": "free", "Link": "https://radio.garden/visit/olivenca-al/2PMgc5oK" },
                { "ID": 12, "Título": "Radiooooo", "Descrição": "Ouça músicas por década e país em um player vintage", "Categoria": "Áudio e Vídeo", "Tipo": "free", "Link": "https://app.radiooooo.com/" },
                { "ID": 13, "Título": "AutoHotkey", "Descrição": "Linguagem de script para automação de tarefas no Windows", "Categoria": "Automação", "Tipo": "free", "Link": "https://www.autohotkey.com/" },
                { "ID": 14, "Título": "IFTTT", "Descrição": "Conecta apps e dispositivos para criar automações", "Categoria": "Automação", "Tipo": "both", "Link": "https://ifttt.com/" },
                { "ID": 15, "Título": "Replit", "Descrição": "IDE online com suporte a automação via scripts em múltiplas linguagens", "Categoria": "Automação", "Tipo": "both", "Link": "https://replit.com/" }, // Changed Cat to Automation from Dev
                { "ID": 16, "Título": "Browser Automation Studio", "Descrição": "Estúdio de Automação avançada para navegadores", "Categoria": "Automação", "Tipo": "both", "Link": "https://bablosoft.com/shop/BrowserAutomationStudio" },
                { "ID": 17, "Título": "N8N", "Descrição": "Automação flexível do fluxo de trabalho de IA entre apps", "Categoria": "Automação", "Tipo": "free", "Link": "https://n8n.io/" },
                { "ID": 18, "Título": "TweetDelete", "Descrição": "Ferramenta para apagar tweets em massa", "Categoria": "Automação", "Tipo": "both", "Link": "https://tweetdelete.net/" }, // Changed Cat to Automation from Social
                { "ID": 19, "Título": "Klaviyo", "Descrição": "Automação de e-mails e SMS com segmentação avançada", "Categoria": "Automação", "Tipo": "both", "Link": "https://www.klaviyo.com/" }, // Changed Cat to Automation from Ecomm/Marketing
                { "ID": 20, "Título": "Solidity", "Descrição": "Linguagem de programação dominante para contratos inteligentes na Ethereum", "Categoria": "Blockchain", "Tipo": "free", "Link": "https://soliditylang.org/" },
                { "ID": 21, "Título": "Truffle Suite", "Descrição": "Framework completo para desenvolvimento Ethereum", "Categoria": "Blockchain", "Tipo": "free", "Link": "https://archive.trufflesuite.com/" },
                { "ID": 22, "Título": "Metamask", "Descrição": "Carteira digital e gateway para interação com dApps via navegadores", "Categoria": "Blockchain", "Tipo": "free", "Link": "https://metamask.io/" },
                { "ID": 23, "Título": "IPFS", "Descrição": "Armazenamento descentralizado para dApps", "Categoria": "Blockchain", "Tipo": "free", "Link": "https://ipfs.tech/" },
                { "ID": 24, "Título": "TatoDesk", "Descrição": "Plataforma de chat ao vivo para atendimento ao cliente", "Categoria": "Comunicação", "Tipo": "free", "Link": "https://tatodesk.com/" },
                { "ID": 25, "Título": "ManyChat", "Descrição": "Ferramenta de automação para chatbots no Facebook Messenger", "Categoria": "Comunicação", "Tipo": "free", "Link": "https://manychat.com/" },
                { "ID": 26, "Título": "ClickUp", "Descrição": "Plataforma de produtividade e colaboração em equipe com chat integrado", "Categoria": "Comunicação", "Tipo": "both", "Link": "https://clickup.com/" }, // Changed Cat to Communication from Productivity
                { "ID": 27, "Título": "Slack", "Descrição": "Aplicativo de mensagens para equipes", "Categoria": "Comunicação", "Tipo": "both", "Link": "https://slack.com/intl/pt-br/" },
                { "ID": 28, "Título": "Zoom", "Descrição": "Plataforma de videoconferências", "Categoria": "Comunicação", "Tipo": "both", "Link": "https://www.zoom.com/pt" },
                { "ID": 29, "Título": "Google Workspace", "Descrição": "E-mail, videoconferências, armazenamento e documentos colaborativos", "Categoria": "Comunicação", "Tipo": "free", "Link": "https://workspace.google.com/" }, // Changed type to 'free' (assuming base plan)
                { "ID": 30, "Título": "Google Acadêmico", "Descrição": "Busca artigos acadêmicos, teses, livros e citações", "Categoria": "Consultas e Buscas", "Tipo": "free", "Link": "https://scholar.google.com/" },
                { "ID": 31, "Título": "SciSpace", "Descrição": "Ferramenta de revisão de literatura com IA", "Categoria": "Consultas e Buscas", "Tipo": "free", "Link": "https://scispace.com/" },
                { "ID": 32, "Título": "Wayback Machine", "Descrição": "Acessa versões históricas de páginas da web", "Categoria": "Consultas e Buscas", "Tipo": "free", "Link": "https://web.archive.org/" },
                { "ID": 33, "Título": "TinEye", "Descrição": "Busca reversa de imagens", "Categoria": "Consultas e Buscas", "Tipo": "free", "Link": "https://www.tineye.com/" },
                { "ID": 34, "Título": "Wolfram Alpha", "Descrição": "Responde perguntas com base em dados estruturados", "Categoria": "Consultas e Buscas", "Tipo": "both", "Link": "https://www.wolframalpha.com/" },
                { "ID": 35, "Título": "Whatsmyname.app", "Descrição": "Verifica nomes de usuário em diversas plataformas", "Categoria": "Consultas e Buscas", "Tipo": "free", "Link": "https://whatsmyname.app/" },
                { "ID": 36, "Título": "Yandex Images", "Descrição": "Busca de imagens alternativa com reconhecimento visual", "Categoria": "Consultas e Buscas", "Tipo": "free", "Link": "https://yandex.com/images/" },
                { "ID": 37, "Título": "Remove.bg", "Descrição": "Remove fundos de imagens automaticamente com IA", "Categoria": "Design", "Tipo": "both", "Link": "https://www.remove.bg/pt-br" },
                { "ID": 38, "Título": "Pexels", "Descrição": "Banco de imagens e vídeos totalmente livre e gratuito", "Categoria": "Design", "Tipo": "free", "Link": "https://www.pexels.com/pt-br/" },
                { "ID": 39, "Título": "TinyPNG", "Descrição": "Compressor inteligente de imagens PNG e JPEG", "Categoria": "Design", "Tipo": "both", "Link": "https://tinypng.com/" },
                { "ID": 40, "Título": "Photopea", "Descrição": "Editor de imagens grátis online similar ao Photoshop", "Categoria": "Design", "Tipo": "free", "Link": "https://www.photopea.com/" },
                { "ID": 41, "Título": "Fontjoy", "Descrição": "Gerador de combinações de fontes harmoniosas", "Categoria": "Design", "Tipo": "free", "Link": "https://fontjoy.com/" },
                { "ID": 42, "Título": "Icons8", "Descrição": "Biblioteca de ícones e ilustrações gratuitas para desenvolvedores", "Categoria": "Design", "Tipo": "both", "Link": "https://icons8.com/" },
                { "ID": 43, "Título": "Colorable", "Descrição": "Teste de contraste de cores para acessibilidade", "Categoria": "Design", "Tipo": "free", "Link": "https://colorable.jxnblk.com/" },
                { "ID": 44, "Título": "Iloveimg", "Descrição": "Ferramentas online para edição de imagens", "Categoria": "Design", "Tipo": "both", "Link": "https://www.iloveimg.com/" },
                { "ID": 45, "Título": "Picsweep", "Descrição": "Organizador e limpador de fotos duplicadas", "Categoria": "Design", "Tipo": "both", "Link": "https://play.google.com/store/apps/details?id=ee.simplesoft.picsweep" }, // Kept Cat Design (image utility)
                { "ID": 46, "Título": "Excalidraw", "Descrição": "Ferramenta de desenho vetorial colaborativo", "Categoria": "Design", "Tipo": "free", "Link": "https://excalidraw.com/" },
                { "ID": 47, "Título": "Duolingo", "Descrição": "Aplicativo gratuito para aprendizado de idiomas", "Categoria": "Educação e Cursos", "Tipo": "both", "Link": "https://www.duolingo.com/" },
                { "ID": 48, "Título": "Coursera", "Descrição": "Cursos online de universidades e empresas renomadas", "Categoria": "Educação e Cursos", "Tipo": "both", "Link": "https://www.coursera.org/" },
                { "ID": 49, "Título": "Khan Academy", "Descrição": "Plataforma gratuita de ensino para todas as idades", "Categoria": "Educação e Cursos", "Tipo": "free", "Link": "https://www.khanacademy.org/" },
                { "ID": 50, "Título": "Sinônimos.com.br", "Descrição": "Dicionário online de sinônimos e antônimos", "Categoria": "Educação e Cursos", "Tipo": "free", "Link": "https://www.sinonimos.com.br/" },
                { "ID": 51, "Título": "Grammarly", "Descrição": "Ferramenta de correção gramatical e de estilo", "Categoria": "Educação e Cursos", "Tipo": "both", "Link": "https://www.grammarly.com/" }, // Changed Cat to Education from Writing
                { "ID": 52, "Título": "Hemingway App", "Descrição": "Editor que ajuda a melhorar a clareza de textos", "Categoria": "Educação e Cursos", "Tipo": "both", "Link": "https://hemingwayapp.com/" }, // Changed Cat to Education from Writing
                { "ID": 53, "Título": "Aprenda+", "Descrição": "Cursos em estrutura de dados, lógica e fundamentos de TI", "Categoria": "Educação e Cursos", "Tipo": "free", "Link": "https://aprendamais.mec.gov.br/" },
                { "ID": 54, "Título": "Sebrae", "Descrição": "Tecnologia aplicada ao empreendedorismo e gestão de negócios digitais", "Categoria": "Educação e Cursos", "Tipo": "free", "Link": "https://sebrae.com.br/sites/PortalSebrae" },
                { "ID": 55, "Título": "Recode", "Descrição": "Inclusão digital com cursos em programação, segurança e análise de dados", "Categoria": "Educação e Cursos", "Tipo": "both", "Link": "https://recode.org.br/" },
                { "ID": 56, "Título": "Dio", "Descrição": "Desenvolvimento de software, bootcamps práticos e comunidade dev", "Categoria": "Educação e Cursos", "Tipo": "both", "Link": "https://www.dio.me/" },
                { "ID": 57, "Título": "Fundação Bradesco", "Descrição": "Cursos de programação (Python, Java, HTML/CSS), redes e governança TI", "Categoria": "Educação e Cursos", "Tipo": "free", "Link": "https://www.ev.org.br/" },
                { "ID": 58, "Título": "FGV", "Descrição": "Cursos em tecnologia, gestão e ciência de dados, certificação gratuita", "Categoria": "Educação e Cursos", "Tipo": "both", "Link": "https://educacao-executiva.fgv.br/sp/sao-paulo" },
                { "ID": 59, "Título": "Dividendos.me", "Descrição": "Acompanhamento de dividendos e investimentos", "Categoria": "Finanças", "Tipo": "free", "Link": "https://play.google.com/store/apps/details?id=com.dividendos.dividendosme" },
                { "ID": 60, "Título": "Venda Fácil", "Descrição": "Sistema de gestão para pequenos comércios e negócios", "Categoria": "Finanças", "Tipo": "both", "Link": "https://play.google.com/store/apps/details?id=com.RodSoftware.vendafacil" }, // Changed Cat to Finance from Ecomm
                { "ID": 61, "Título": "XE Currency", "Descrição": "Conversor de moedas e taxas de câmbio em tempo real", "Categoria": "Finanças", "Tipo": "free", "Link": "https://www.xe.com/" },
                { "ID": 62, "Título": "Minhas Economias", "Descrição": "Gestão de orçamento pessoal, categorização de gastos e relatórios", "Categoria": "Finanças", "Tipo": "free", "Link": "https://minhaseconomias.com.br/" },
                { "ID": 63, "Título": "Organizze", "Descrição": "Controle de conta bancária, cartão e planejamento com alerta", "Categoria": "Finanças", "Tipo": "both", "Link": "https://www.organizze.com.br/" },
                { "ID": 64, "Título": "Money Lover", "Descrição": "Rastreamento de gastos, orçamento por categorias e relatórios visuais", "Categoria": "Finanças", "Tipo": "free", "Link": "https://moneylover.me" },
                { "ID": 65, "Título": "Invoice Ninja", "Descrição": "Sistema de faturamento e gestão financeira para autônomos", "Categoria": "Finanças", "Tipo": "both", "Link": "https://invoiceninja.com/" },
                { "ID": 66, "Título": "GeoSpy", "Descrição": "Identifique a localização de fotos usando inteligência artificial", "Categoria": "Geolocalização", "Tipo": "both", "Link": "https://geospy.ai/" },
                { "ID": 67, "Título": "Flightradar24", "Descrição": "Acompanhe voos em tempo real em um mapa interativo", "Categoria": "Geolocalização", "Tipo": "free", "Link": "https://www.flightradar24.com/-9.23,-37.38/6" },
                { "ID": 68, "Título": "Qgis", "Descrição": "Software de código aberto para análise geoespacial avançada", "Categoria": "Geolocalização", "Tipo": "free", "Link": "https://qgis.org/" },
                { "ID": 69, "Título": "Windy", "Descrição": "Previsão do tempo com mapas interativos de ventos", "Categoria": "Geolocalização", "Tipo": "free", "Link": "https://www.windy.com/?-9.524,-37.313,13" },
                { "ID": 70, "Título": "Rome2rio", "Descrição": "Planeje rotas e compare opções de transporte entre locais", "Categoria": "Geolocalização", "Tipo": "free", "Link": "https://www.rome2rio.com/" },
                { "ID": 71, "Título": "Here WeGo", "Descrição": "Navegação com rotas otimizadas e mapas offline", "Categoria": "Geolocalização", "Tipo": "free", "Link": "https://wego.here.com/" },
                { "ID": 72, "Título": "Receita Federal (CPF)", "Descrição": "Consulta e impressão de comprovante de CPF", "Categoria": "Serviços do Governo", "Tipo": "free", "Link": "https://servicos.receita.fazenda.gov.br/Servicos/CPF/ImpressaoComprovante/ConsultaImpressao.asp" },
                { "ID": 73, "Título": "BCB Registrato", "Descrição": "Consulta de dívidas e informações bancárias no Banco Central", "Categoria": "Serviços do Governo", "Tipo": "free", "Link": "https://www.bcb.gov.br/meubc/registrato" },
                { "ID": 74, "Título": "Consumidor.gov.br", "Descrição": "Plataforma de reclamações do governo federal", "Categoria": "Serviços do Governo", "Tipo": "free", "Link": "https://www.consumidor.gov.br/pages/principal/?1742832916394" },
                { "ID": 75, "Título": "Meu INSS", "Descrição": "Solicitação de aposentadorias, perícias, consulta de benefícios", "Categoria": "Serviços do Governo", "Tipo": "free", "Link": "https://meu.inss.gov.br/" },
                { "ID": 76, "Título": "Receita Federal (e-CAC)", "Descrição": "Declaração IR, certidões, consulta débitos fiscais", "Categoria": "Serviços do Governo", "Tipo": "free", "Link": "https://www.gov.br/receitafederal/pt-br" },
                { "ID": 77, "Título": "Sistema eSocial", "Descrição": "Unificação de obrigações trabalhistas, previdenciárias e fiscais", "Categoria": "Serviços do Governo", "Tipo": "free", "Link": "https://www.gov.br/esocial/pt-br" },
                { "ID": 78, "Título": "Metasploit Framework", "Descrição": "Framework de testes de penetração para exploração de vulnerabilidades", "Categoria": "Hacking", "Tipo": "free", "Link": "https://www.metasploit.com" },
                { "ID": 79, "Título": "Burp Suite", "Descrição": "Scanner de segurança para aplicações web", "Categoria": "Hacking", "Tipo": "free", "Link": "https://portswigger.net/burp/communitydownload" },
                { "ID": 80, "Título": "Aircrack-ng", "Descrição": "Quebra de criptografia Wi-Fi (WEP/WPA/WPA2)", "Categoria": "Hacking", "Tipo": "free", "Link": "https://www.aircrack-ng.org/" },
                { "ID": 81, "Título": "John the Ripper", "Descrição": "Quebra de senhas via força bruta e dicionário", "Categoria": "Hacking", "Tipo": "free", "Link": "https://www.openwall.com/john/" },
                { "ID": 82, "Título": "SQLMap", "Descrição": "Automatização de exploração de vulnerabilidades SQL Injection", "Categoria": "Hacking", "Tipo": "free", "Link": "https://sqlmap.org/" },
                { "ID": 83, "Título": "OWASP ZAP", "Descrição": "Scanner de vulnerabilidades em aplicações web", "Categoria": "Hacking", "Tipo": "free", "Link": "https://www.zaproxy.org/" },
                { "ID": 84, "Título": "THC Hydra", "Descrição": "Ataques de força bruta em serviços de rede", "Categoria": "Hacking", "Tipo": "free", "Link": "https://sectools.org/tool/hydra/" },
                { "ID": 85, "Título": "Maltego", "Descrição": "Inteligência de código aberto e análise forense digital", "Categoria": "Hacking", "Tipo": "both", "Link": "https://www.maltego.com/" },
                { "ID": 86, "Título": "Nikto", "Descrição": "Scanner de vulnerabilidades em servidores web", "Categoria": "Hacking", "Tipo": "free", "Link": "https://github.com/sullo/nikto" },
                { "ID": 87, "Título": "ChatGPT", "Descrição": "Assistente de IA para diversas tarefas", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://chat.openai.com/" },
                { "ID": 88, "Título": "Synthesia", "Descrição": "Criação de vídeos com avatares de IA", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://www.synthesia.io/?r=0" },
                { "ID": 89, "Título": "Midjourney", "Descrição": "Crie imagens incríveis com IA", "Categoria": "Inteligência Artificial", "Tipo": "paid", "Link": "https://www.midjourney.com/" },
                { "ID": 90, "Título": "Claude.ai", "Descrição": "Assistente de IA para comunicação avançada", "Categoria": "Inteligência Artificial", "Tipo": "free", "Link": "https://claude.ai/" },
                { "ID": 91, "Título": "Perplexity AI", "Descrição": "Assistente de pesquisa com respostas precisas e fontes verificadas", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://www.perplexity.ai/" },
                { "ID": 92, "Título": "Wolfram Alpha AI", "Descrição": "Motor de conhecimento computacional para cálculos complexos (AI)", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://www.wolframalpha.com/" }, // Duplicate ID 34, keeping as IA here with modified name
                { "ID": 93, "Título": "ElevenLabs", "Descrição": "Geração de vozes realistas com IA para áudios e narrações", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://elevenlabs.io/" },
                { "ID": 94, "Título": "Photomath", "Descrição": "Resolução de problemas matemáticos com reconhecimento de câmera", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://photomath.com/" },
                { "ID": 95, "Título": "NanoNets", "Descrição": "Plataforma de IA para automação de processamento de documentos", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://nanonets.com/" },
                { "ID": 96, "Título": "Hugging Face Spaces", "Descrição": "Repositório de modelos de IA open-source para desenvolvedores", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://huggingface.co/spaces" },
                { "ID": 97, "Título": "Pika.style", "Descrição": "Geração e edição de vídeos usando comandos de texto", "Categoria": "Inteligência Artificial", "Tipo": "both", "Link": "https://pika.style/" },
                { "ID": 98, "Título": "Pointer Pointer", "Descrição": "Jogo curioso que encontra imagens de pessoas apontando para seu cursor", "Categoria": "Jogos", "Tipo": "free", "Link": "https://pointerpointer.com/" },
                { "ID": 99, "Título": "Geoguessr", "Descrição": "Desafio geográfico que testa seu conhecimento de localização", "Categoria": "Jogos", "Tipo": "both", "Link": "https://www.geoguessr.com/" },
                { "ID": 100, "Título": "Tibia", "Descrição": "Experiência única de RPG online", "Categoria": "Jogos", "Tipo": "both", "Link": "https://www.tibia.com/mmorpg/free-multiplayer-online-role-playing-game.php" },
                { "ID": 101, "Título": "Parsec", "Descrição": "Streaming de jogos em tempo real com baixa latência", "Categoria": "Jogos", "Tipo": "both", "Link": "https://parsec.app/" },
                { "ID": 102, "Título": "OBS Studio", "Descrição": "Software livre para captura e transmissão ao vivo de gameplay", "Categoria": "Jogos", "Tipo": "free", "Link": "https://obsproject.com/" }, // Changed Cat to Games from Audio/Video
                { "ID": 103, "Título": "Trello", "Descrição": "Quadros Kanban para organização de projetos e tarefas", "Categoria": "Produtividade", "Tipo": "both", "Link": "https://trello.com/" },
                { "ID": 104, "Título": "To Do List", "Descrição": "Ferramenta simples para organizar tarefas do dia a dia", "Categoria": "Produtividade", "Tipo": "both", "Link": "https://play.google.com/store/apps/details?id=com.splendapps.splendo" },
                { "ID": 105, "Título": "Calendly", "Descrição": "Agendamento automático de reuniões e compromissos", "Categoria": "Produtividade", "Tipo": "both", "Link": "https://calendly.com/" },
                { "ID": 106, "Título": "Miro", "Descrição": "Quadros virtuais colaborativos para brainstorming", "Categoria": "Produtividade", "Tipo": "both", "Link": "https://miro.com/" },
                { "ID": 107, "Título": "Snipd", "Descrição": "Organize e aproveite podcasts com recortes inteligentes", "Categoria": "Produtividade", "Tipo": "both", "Link": "https://www.snipd.com/" },
                { "ID": 108, "Título": "Tactiq.io", "Descrição": "Transcrição em tempo real de reuniões no Google Meet e Zoom", "Categoria": "Produtividade", "Tipo": "both", "Link": "https://tactiq.io/" },
                { "ID": 109, "Título": "Nmap", "Descrição": "Mapeamento de redes, varredura de portas e detecção", "Categoria": "Redes", "Tipo": "free", "Link": "https://nmap.org/" },
                { "ID": 110, "Título": "Wireshark", "Descrição": "Análise avançada de tráfego de rede em tempo real", "Categoria": "Redes", "Tipo": "free", "Link": "https://www.wireshark.org/" },
                { "ID": 111, "Título": "Zabbix", "Descrição": "Solução de monitoramento de rede open-source", "Categoria": "Redes", "Tipo": "free", "Link": "https://www.zabbix.com/" },
                { "ID": 112, "Título": "Gns3", "Descrição": "Simulador de redes para virtualização de infraestrutura", "Categoria": "Redes", "Tipo": "both", "Link": "https://www.gns3.com/" },
                { "ID": 113, "Título": "Kickidler", "Descrição": "Software de monitoramento de rede e produtividade", "Categoria": "Redes", "Tipo": "both", "Link": "https://www.kickidler.com/" },
                { "ID": 114, "Título": "Cisco NetAcad", "Descrição": "Plataforma educacional em redes de computadores", "Categoria": "Redes", "Tipo": "both", "Link": "https://www.netacad.com/" },
                { "ID": 115, "Título": "DNSChecker", "Descrição": "Ferramenta de análise e propagação de DNS", "Categoria": "Redes", "Tipo": "free", "Link": "https://dnschecker.org/" },
                { "ID": 116, "Título": "Nike Training Club", "Descrição": "Treinos em casa, planos personalizados", "Categoria": "Saúde e Bem Estar", "Tipo": "free", "Link": "https://www.nike.com/ntc-app" },
                { "ID": 117, "Título": "Google Fit", "Descrição": "Rastreamento de passos, corrida, ciclismo e métricas", "Categoria": "Saúde e Bem Estar", "Tipo": "free", "Link": "https://www.google.com/fit/" },
                { "ID": 118, "Título": "WaterMinder", "Descrição": "Lembretes para beber água, cálculo de metas diárias", "Categoria": "Saúde e Bem Estar", "Tipo": "both", "Link": "https://waterminder.com/" },
                { "ID": 119, "Título": "Flo", "Descrição": "Acompanhamento menstrual, dicas de saúde reprodutiva", "Categoria": "Saúde e Bem Estar", "Tipo": "both", "Link": "https://flo.health/" },
                { "ID": 120, "Título": "Sleep Cycle", "Descrição": "Análise de padrões de sono, despertador inteligente", "Categoria": "Saúde e Bem Estar", "Tipo": "both", "Link": "https://sleepcycle.com/" },
                { "ID": 121, "Título": "Headspace", "Descrição": "Sessões de meditação para ansiedade, sono e foco", "Categoria": "Saúde e Bem Estar", "Tipo": "both", "Link": "https://www.headspace.com/pt" },
                { "ID": 122, "Título": "MyFitnessPal", "Descrição": "Contagem de calorias, banco de dados de alimentos", "Categoria": "Saúde e Bem Estar", "Tipo": "both", "Link": "https://www.myfitnesspal.com/pt" },
                { "ID": 123, "Título": "EatThisMuch", "Descrição": "Planejador de dietas e cardápios personalizados", "Categoria": "Saúde e Bem Estar", "Tipo": "both", "Link": "https://www.eatthismuch.com/" },
                { "ID": 124, "Título": "Bitwarden", "Descrição": "Gerenciador e controle de senhas open-source e seguro", "Categoria": "Segurança e Privacidade", "Tipo": "both", "Link": "https://bitwarden.com/" },
                { "ID": 125, "Título": "Proton Mail", "Descrição": "Serviço de e-mail com criptografia de ponta a ponta", "Categoria": "Segurança e Privacidade", "Tipo": "both", "Link": "https://proton.me/mail" },
                { "ID": 126, "Título": "Temp-Mail", "Descrição": "E-mail temporário e descartável para cadastros", "Categoria": "Segurança e Privacidade", "Tipo": "both", "Link": "https://temp-mail.org/" },
                { "ID": 127, "Título": "VirusTotal", "Descrição": "Scanner de arquivos e URLs para detecção de malware", "Categoria": "Segurança e Privacidade", "Tipo": "free", "Link": "https://www.virustotal.com/" },
                { "ID": 128, "Título": "Tails", "Descrição": "Focado em privacidade e anonimato, ideal para evitar rastreamento", "Categoria": "Segurança e Privacidade", "Tipo": "free", "Link": "https://tails.net/" },
                { "ID": 129, "Título": "PrivacyTools.io", "Descrição": "Recursos para proteção de privacidade digital", "Categoria": "Segurança e Privacidade", "Tipo": "free", "Link": "https://www.privacytools.io/" },
                { "ID": 130, "Título": "Google Lens", "Descrição": "Pesquisa visual usando sua câmera ou imagens", "Categoria": "Utilitários", "Tipo": "free", "Link": "https://lens.google/" },
                { "ID": 131, "Título": "Notion", "Descrição": "Tudo em um só lugar: notas, tarefas e bancos de dados", "Categoria": "Utilitários", "Tipo": "free", "Link": "https://www.notion.so/" }, // Changed Cat to Utilities from Productivity
                { "ID": 132, "Título": "CamScanner", "Descrição": "Digitalizador de arquivos e documentos via smartphone", "Categoria": "Utilitários", "Tipo": "both", "Link": "https://www.camscanner.com/" },
                { "ID": 133, "Título": "Zamzar", "Descrição": "Conversor online de arquivos em diversos formatos", "Categoria": "Utilitários", "Tipo": "both", "Link": "https://www.zamzar.com/" },
                { "ID": 134, "Título": "12ft.io", "Descrição": "Removedor de paywalls para visualizar artigos bloqueados", "Categoria": "Utilitários", "Tipo": "free", "Link": "https://12ft.io/" },
                { "ID": 135, "Título": "PDF24 Tools", "Descrição": "Suíte completa para edição e conversão de PDFs", "Categoria": "Utilitários", "Tipo": "free", "Link": "https://tools.pdf24.org/pt/" },
                { "ID": 136, "Título": "StackEdit", "Descrição": "Editor Markdown online com pré-visualização em tempo real", "Categoria": "Utilitários", "Tipo": "free", "Link": "https://stackedit.io/" },
                { "ID": 137, "Título": "Catho", "Descrição": "Plataforma de empregos e oportunidades profissionais", "Categoria": "Outros", "Tipo": "both", "Link": "https://www.catho.com.br/" },
                { "ID": 138, "Título": "Ninite", "Descrição": "Instalador múltiplo de programas essenciais", "Categoria": "Outros", "Tipo": "free", "Link": "https://ninite.com/" },
                { "ID": 139, "Título": "Magie.com.br", "Descrição": "Gerador de documentos e contratos automáticos", "Categoria": "Outros", "Tipo": "both", "Link": "https://magie.com.br/" },
                { "ID": 140, "Título": "Talo.ai", "Descrição": "Plataforma de análise de dados para negócios", "Categoria": "Outros", "Tipo": "both", "Link": "https://talo.ai/" }, // Could be 'data-analysis'
                { "ID": 141, "Título": "Digitar-online.com", "Descrição": "Teste e melhore sua velocidade de digitação", "Categoria": "Outros", "Tipo": "free", "Link": "https://digitar-online.com/" }, // Could be 'education' or 'utilities'
                { "ID": 142, "Título": "Birthday Calendar", "Descrição": "Organizador de aniversários e datas importantes", "Categoria": "Outros", "Tipo": "both", "Link": "https://play.google.com/store/apps/details?id=dev.cwolf.birthdaycalendar" }, // Could be 'productivity'
                { "ID": 143, "Título": "MyNoise", "Descrição": "Gerador de sons ambientes para concentração e relaxamento", "Categoria": "Outros", "Tipo": "both", "Link": "https://mynoise.net/" } // Could be 'health' or 'productivity'
            ];


            // Mapping from Portuguese category name to English ID used in CATEGORIES array
            const portugueseToEnglishCategoryMap = {
                "Inteligência Artificial": "ai",
                "Utilitários": "utilities",
                "Design": "design",
                "Automação": "automation",
                "Jogos": "games",
                "Consultas e Buscas": "search", // Mapped to 'search'
                "Áudio e Vídeo": "audio-video",
                "Blockchain": "blockchain",
                "Comunicação": "communication",
                "Educação e Cursos": "education", // Mapped to 'education'
                "Finanças": "finance",
                "Geolocalização": "geolocation", // Mapped to 'geolocation'
                "Serviços do Governo": "government", // Mapped to 'government'
                "Hacking": "hacking", // Mapped to 'hacking'
                "Produtividade": "productivity",
                "Redes": "network", // Mapped to 'network'
                "Saúde e Bem Estar": "health", // Mapped to 'health'
                "Segurança e Privacidade": "security", // Mapped to 'security'
                "Outros": "others"
                // Add more mappings if new categories appear in input
            };

            let currentId = 1; // Start ID counter
            const seenIds = new Set();
            const processedTools = [];

            inputData.forEach(item => {
                let uniqueId = item.ID;
                 // Handle duplicate or missing IDs from input
                 if (uniqueId === undefined || uniqueId === null || seenIds.has(uniqueId) || uniqueId === 34 && item.Título.includes('AI')) { // Specifically handle the Wolfram Alpha AI duplicate
                     uniqueId = tools.length > 0 ? Math.max(...tools.map(t => t.id), ...processedTools.map(t => t.id)) + 1 : currentId;
                      while (seenIds.has(uniqueId)) {
                          uniqueId++;
                      }
                      console.warn(`Adjusted ID for "${item.Título}". Original: ${item.ID}, New: ${uniqueId}`);
                 }
                 seenIds.add(uniqueId);
                 currentId = Math.max(currentId, uniqueId + 1);


                const mappedCategory = portugueseToEnglishCategoryMap[item.Categoria] || 'others'; // Default to 'others' if not found

                processedTools.push({
                    id: uniqueId, // Use the potentially adjusted unique ID
                    name: item.Título,
                    description: item.Descrição,
                    category: mappedCategory,
                    type: item.Tipo, // Assuming 'free', 'paid', 'both' match
                    url: item.Link,
                    media: null, // Let card functions handle default/fallback
                    rating: randomRating(), // Generate random rating
                    dateAdded: randomDate(), // Generate random date added
                    featured: false, // Default value
                    essential: false, // Default value
                    badge: null // Default value
                });
            });

             tools = processedTools; // Assign the processed list

            // Optional: Mark first few items as featured or essential for demonstration
             const markFeatured = (id) => { const tool = tools.find(t => t.id === id); if (tool) tool.featured = true; };
             const markEssential = (id) => { const tool = tools.find(t => t.id === id); if (tool) tool.essential = true; };

             markFeatured(1); // Deepseek
             markFeatured(3); // Coolors
             markFeatured(87); // ChatGPT
             markEssential(87); // ChatGPT
             markEssential(91); // Perplexity AI
             markEssential(40); // Photopea
             markEssential(131); // Notion
             markEssential(2); // ilovepdf

             // Sort by ID initially, if desired (optional)
             tools.sort((a, b) => a.id - b.id);

             console.log(`Processed ${tools.length} tools from user data.`);
        }


         // --- Card Creation Functions (Robust Versions with Fallbacks) ---
         function createToolCard(tool = {}) {
             const card = document.createElement('div'); card.className = 'tool-card overflow-hidden';
             let typeClass = '', typeText = '';
             switch(tool.type) { case 'free': typeClass = 'tag-free'; typeText = 'Grátis'; break; case 'paid': typeClass = 'tag-paid'; typeText = 'Pago'; break; case 'both': typeClass = 'tag-both'; typeText = 'Grátis/Pago'; break; default: typeClass = 'bg-gray-500 text-white tag'; typeText = tool.type || '?'; }
             const isVideo = tool.media && (tool.media.includes('.mp4') || tool.media.includes('.webm'));
             const categoryInfo = CATEGORIES.find(c => c.id === tool.category) || CATEGORIES.find(c => c.id === 'others') || { id: 'others', name: 'Outros', icon: 'cog', keywords: 'tool' };
             const safeUrl = tool.url && tool.url.startsWith('http') ? tool.url : '#';
             // MODIFIED: Use DEFAULT_IMAGE_URL first, then fallback
             const mediaUrl = tool.media || DEFAULT_IMAGE_URL;
             const fallbackMediaUrl = `https://source.unsplash.com/random/800x600/?abstract,technology&sig=${Math.random()}`; // Final fallback
             // END MODIFICATION
             const toolName = tool.name || 'Ferramenta Sem Nome';
             const toolDesc = tool.description || 'Sem descrição disponível.';
             const toolRating = tool.rating || 'N/A';

             // Sanitize potentially user-provided strings for attributes like title, alt
             const safeToolName = toolName.replace(/"/g, '&quot;'); // Escape quotes for HTML attributes
             const safeToolDesc = toolDesc.replace(/"/g, '&quot;');

             card.innerHTML = `
                 <a href="${safeUrl}" target="_blank" rel="noopener noreferrer" class="group flex flex-col h-full">
                    <div class="relative tool-media-container">
                        ${isVideo ? `<video src="${mediaUrl}" class="absolute inset-0 w-full h-full object-cover" loop muted playsinline disablepictureinpicture controlslist="nodownload nofullscreen noremoteplayback" aria-label="${safeToolName} video preview"></video>`
                                 // MODIFIED: Added onerror fallback
                                 : `<img src="${mediaUrl}" alt="${safeToolName} preview image" class="absolute inset-0 w-full h-full object-cover" loading="lazy" onerror="this.onerror=null; this.src='${fallbackMediaUrl}';">`}
                                 // END MODIFICATION
                         <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent opacity-75 group-hover:opacity-90 transition-opacity duration-300"></div>
                         <div class="absolute top-2 right-2 z-10"><span class="${typeClass} tag">${typeText}</span></div>
                         ${tool.badge ? `<div class="absolute top-2 left-2 z-10"><span class="tag-badge tag">${tool.badge}</span></div>` : ''}
                         <div class="absolute bottom-2 left-2 right-2 z-10 flex justify-between items-center gap-2">
                            <div class="flex items-center gap-2"> ${tool.essential ? `<span class="tag-essential tag flex items-center"><i class="fas fa-check-circle mr-1 text-xs"></i> Essencial</span>` : ''}</div>
                            <div class="flex items-center bg-black/50 text-white px-2 py-0.5 rounded-full text-xs"><i class="fas fa-star text-yellow-400 text-xs mr-1"></i><span class="font-semibold">${toolRating}</span></div>
                         </div>
                    </div>
                     <div class="p-4 md:p-5 flex flex-col flex-grow">
                        <h4 class="text-md lg:text-lg font-bold mb-1.5 text-text-heading group-hover:text-accent transition-colors duration-300 truncate" title="${safeToolName}">${toolName}</h4>
                         <p class="text-text-muted text-sm mb-4 flex-grow line-clamp-3">${toolDesc}</p> <!-- Use original description for display -->
                         <div class="mt-auto pt-3 border-t border-border-color"><span class="tag-category tag"><i class="fas fa-${categoryInfo.icon || 'cog'} mr-1.5 text-xs opacity-75"></i>${categoryInfo.name || 'Outros'}</span></div>
                     </div>
                 </a>`;
             if (isVideo) { const video = card.querySelector('video'); if(video){ card.addEventListener('mouseenter', () => video.play().catch(e => {})); card.addEventListener('mouseleave', () => { video.pause(); video.currentTime = 0; }); } }
             return card;
         }

         function createListToolCard(tool = {}) {
            const card = document.createElement('div'); card.className = 'tool-card overflow-hidden flex flex-col md:flex-row';
            let typeClass = '', typeText = '';
            switch(tool.type) { case 'free': typeClass = 'tag-free'; typeText = 'Grátis'; break; case 'paid': typeClass = 'tag-paid'; typeText = 'Pago'; break; case 'both': typeClass = 'tag-both'; typeText = 'Grátis/Pago'; break; default: typeClass = 'bg-gray-500 text-white tag'; typeText = tool.type || '?'; }
            const isVideo = tool.media && (tool.media.includes('.mp4') || tool.media.includes('.webm'));
            const categoryInfo = CATEGORIES.find(c => c.id === tool.category) || CATEGORIES.find(c => c.id === 'others') || { id: 'others', name: 'Outros', icon: 'cog', keywords: 'tool' };
            const dateFormatted = tool.dateAdded ? new Date(tool.dateAdded).toLocaleDateString('pt-BR', { year: '2-digit', month: 'short', day: 'numeric'}) : 'N/A';
            const safeUrl = tool.url && tool.url.startsWith('http') ? tool.url : '#';
            // MODIFIED: Use DEFAULT_IMAGE_URL first, then fallback
            const mediaUrl = tool.media || DEFAULT_IMAGE_URL;
            const fallbackMediaUrl = `https://source.unsplash.com/random/800x600/?abstract,technology&sig=${Math.random()}`; // Final fallback
            // END MODIFICATION
            const toolName = tool.name || 'Ferramenta Sem Nome';
            const toolDesc = tool.description || 'Sem descrição.';
            const toolRating = tool.rating || 'N/A';
            const safeToolName = toolName.replace(/"/g, '&quot;'); // Escape quotes for HTML attributes

             card.innerHTML = `
                 <a href="${safeUrl}" target="_blank" rel="noopener noreferrer" class="flex flex-col md:flex-row w-full group">
                    <div class="relative tool-media-container-list md:h-auto">
                         ${isVideo ? `<video src="${mediaUrl}" class="absolute inset-0 w-full h-full object-cover" loop muted playsinline disablepictureinpicture controlslist="nodownload nofullscreen noremoteplayback" aria-label="${safeToolName} video preview"></video>`
                                  // MODIFIED: Added onerror fallback
                                  : `<img src="${mediaUrl}" alt="${safeToolName} preview image" class="absolute inset-0 w-full h-full object-cover" loading="lazy" onerror="this.onerror=null; this.src='${fallbackMediaUrl}';">`}
                                  // END MODIFICATION
                         ${tool.badge ? `<div class="absolute top-2 left-2 z-10"><span class="tag-badge tag">${tool.badge}</span></div>` : ''}
                     </div>
                      <div class="flex-grow p-4 md:p-5 flex flex-col">
                         <div class="flex justify-between items-start mb-2 gap-3">
                             <h4 class="text-lg font-bold text-text-heading group-hover:text-accent transition-colors duration-300 mr-2">${toolName}</h4>
                             <span class="${typeClass} tag whitespace-nowrap">${typeText}</span>
                         </div>
                         <p class="text-text-muted text-sm mb-4 line-clamp-2 flex-grow">${toolDesc}</p>
                         <div class="mt-auto pt-3 border-t border-border-color flex flex-wrap justify-between items-center gap-x-4 gap-y-2 text-xs">
                             <span class="tag-category tag"><i class="fas fa-${categoryInfo.icon || 'cog'} mr-1.5 text-xs opacity-75"></i>${categoryInfo.name || 'Outros'}</span>
                             <div class="flex items-center space-x-3 text-text-muted">
                                 <div class="flex items-center" title="Avaliação"><i class="fas fa-star text-yellow-400 mr-1"></i><span class="font-semibold">${toolRating}</span></div>
                                 <div class="flex items-center" title="Adicionado"><i class="fas fa-calendar-alt mr-1"></i><span>${dateFormatted}</span></div>
                                 ${tool.essential ? `<span class="tag-essential tag flex items-center"><i class="fas fa-check-circle mr-1 text-xs"></i> Essencial</span>` : ''}
                             </div>
                         </div>
                     </div>
                 </a>`;
            if (isVideo) { const video = card.querySelector('video'); if(video){ card.addEventListener('mouseenter', () => video.play().catch(e => {})); card.addEventListener('mouseleave', () => { video.pause(); video.currentTime = 0; }); } }
            return card;
         }

    </script>

</body>
</html>
